<!DOCTYPE html> <html><head>
		<title>x86-64 어셈블리 명령어 Pt.2</title>
		<base href="..\..\../">
		<meta id="root-path" root-path="..\..\../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="Obsidian Vault - x86-64 어셈블리 명령어 Pt.2">
		<meta property="og:title" content="x86-64 어셈블리 명령어 Pt.2">
		<meta property="og:description" content="Obsidian Vault - x86-64 어셈블리 명령어 Pt.2">
		<meta property="og:type" content="website">
		<meta property="og:url" content="achive/dreamhack/시스템-해킹/x86-64-어셈블리-명령어-pt.2.html">
		<meta property="og:image" content="lib\media\pasted-image-20240923150626.png">
		<meta property="og:site_name" content="Obsidian Vault">
		<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="lib/scripts/pixi.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="lib/scripts/minisearch.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><include src="lib/html/custom-head-content.html"></include><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="preload" href="lib/styles/other-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/other-plugins.css"></noscript><link rel="stylesheet" href="lib/styles/theme.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript><link rel="preload" href="lib/styles/snippets.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/snippets.css"></noscript></head><body class="publish css-settings-manager theme-dark show-inline-title show-ribbon ctp-latte ctp-mocha ctp-accent-rosewater anuppuccin-accent-toggle anp-h1-red anp-h2-peach anp-h3-green anp-h4-teal anp-h5-lavender anp-h6-mauve anp-bold-red anp-italic-green anp-highlight-yellow"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="x86-64 어셈블리 명령어 Pt.2"><p dir="auto">x86-64 어셈블리 명령어 Pt.2</p></h1><div class="heading-wrapper"><h4 data-heading="Opcode: 스택🧱" dir="auto" class="heading" id="Opcode:_스택🧱"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Opcode: 스택🧱</h4><div class="heading-children"><div><hr></div><div><p dir="auto">x64 아키텍처에서는 다음의 명령어로 스택을 조작할 수 있습니다.</p></div><div dir="ltr" style="overflow-x: auto;"><table>
<thead>
<tr>
<th dir="ltr"><strong>push val : val을 스택 최상단에 쌓음</strong></th>
<th dir="auto"></th>
<th dir="auto"></th>
<th dir="auto"></th>
</tr>
</thead>
<tbody>
<tr>
<td dir="ltr"><strong>연산</strong>  <br><code>rsp -= 8</code>  <br><code>[rsp] = val</code></td>
<td dir="auto"></td>
<td dir="auto"></td>
<td dir="auto"></td>
</tr>
</tbody>
</table></div><div><div data-callout-metadata="" data-callout-fold="" data-callout="example" class="callout"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-list"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg></div><div class="callout-title-inner">Example</div></div></div></div><div><pre><code>
[Register]
rsp = 0x7fffffffc400

[Stack]
0x7fffffffc400 | 0x0  &lt;- rsp
0x7fffffffc408 | 0x0

[Code]
push 0x31337
</code><button class="copy-code-button">복사</button></pre></div><div><p dir="auto">결과 </p></div><div><pre><code>[Register]
rsp = 0x7fffffffc3f8

[Stack]
0x7fffffffc3f8 | 0x31337 &lt;- rsp 
0x7fffffffc400 | 0x0
0x7fffffffc408 | 0x0
</code><button class="copy-code-button">복사</button></pre></div><div dir="ltr" style="overflow-x: auto;"><table>
<thead>
<tr>
<th dir="ltr"><strong>pop reg : 스택 최상단의 값을 꺼내서 reg에 대입</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td dir="ltr"><strong>연산</strong>  <br><code>rsp += 8</code>  <br><code>reg = [rsp-8]</code></td>
</tr>
</tbody>
</table></div><div><div data-callout-metadata="" data-callout-fold="" data-callout="example" class="callout"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-list"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg></div><div class="callout-title-inner">Example</div></div></div></div><div><pre><code>[Register]
rax = 0
rsp = 0x7fffffffc3f8

[Stack]
0x7fffffffc3f8 | 0x31337 &lt;- rsp 
0x7fffffffc400 | 0x0
0x7fffffffc408 | 0x0

[Code]
pop rax
</code><button class="copy-code-button">복사</button></pre></div><div><p dir="auto">결과</p></div><div><pre><code>[Register]
rax = 0x31337
rsp = 0x7fffffffc400

[Stack]
0x7fffffffc400 | 0x0 &lt;- rsp 
0x7fffffffc408 | 0x0
</code><button class="copy-code-button">복사</button></pre></div></div></div><div class="heading-wrapper"><h4 data-heading="Opcode: 프로시저📜" dir="auto" class="heading" id="Opcode:_프로시저📜"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Opcode: 프로시저📜</h4><div class="heading-children"><div><hr></div><div><p dir="auto"><strong>프로시저(Procedure)</strong>는 특정 기능을 수행하는 코드 조각을 말합니다.<br>
프로시저를 부르는 행위를 <strong>호출(Call)</strong>이라고 부르며, 프로시저에서 돌아오는 것을 <strong>반환(Return)</strong>이라고 부릅니다. 프로시저를 호출할 때는 프로시저를 실행하고 나서 원래의 실행 흐름으로 돌아와야 하므로, <strong>call 다음의 명령어 주소(Return Address, 반환 주소)</strong>를 스택에 저장하고 프로시저로 rip를 이동시킵니다.<br>
x64어셈블리언어에는 프로시저의 호출과 반환을 위한 call, leave, ret 명령어가 있습니다.</p></div><div dir="auto" style="overflow-x: auto;"><table>
<thead>
<tr>
<th dir="auto"></th>
</tr>
</thead>
<tbody>
<tr>
<td dir="ltr"><strong>call addr : addr에 위치한 프로시져 호출</strong></td>
</tr>
<tr>
<td dir="ltr"><strong>연산</strong>  <br><code>push return_address</code>  <br><code>jmp addr</code></td>
</tr>
</tbody>
</table></div><div><pre><code>[Register]
rip = 0x400000
rsp = 0x7fffffffc400 

[Stack]
0x7fffffffc3f8 | 0x0
0x7fffffffc400 | 0x0 &lt;- rsp

[Code]
0x400000 | call 0x401000  &lt;- rip
0x400005 | mov esi, eax
...
0x401000 | push rbp
</code><button class="copy-code-button">복사</button></pre></div><div><p dir="auto">결과</p></div><div><pre><code>[Register]
rip = 0x401000
rsp = 0x7fffffffc3f8

[Stack]
0x7fffffffc3f8 | 0x400005  &lt;- rsp
0x7fffffffc400 | 0x0

[Code]
0x400000 | call 0x401000
0x400005 | mov esi, eax
...
0x401000 | push rbp  &lt;- rip
</code><button class="copy-code-button">복사</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="레지스터 상태:" dir="auto" class="heading" id="레지스터_상태:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>레지스터 상태:</h3><div class="heading-children"><div><ul>
<li data-line="0" dir="auto"><code>rip = 0x400000</code>: 현재 실행 중인 명령어의 주소를 가리킵니다.</li>
<li data-line="1" dir="auto"><code>rsp = 0x7fffffffc400</code>: 스택 포인터로, 현재 스택의 최상위 주소를 가리킵니다.</li>
</ul></div></div></div><div class="heading-wrapper"><h3 data-heading="스택 상태:" dir="auto" class="heading" id="스택_상태:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>스택 상태:</h3><div class="heading-children"><div><ul>
<li data-line="0" dir="auto"><code>0x7fffffffc3f8 | 0x0</code>: 이 주소에는 값 <code>0x0</code>이 저장되어 있습니다.</li>
<li data-line="1" dir="auto"><code>0x7fffffffc400 | 0x0</code>: 이 주소에는 값 <code>0x0</code>이 저장되어 있으며, 이 주소가 현재 <code>rsp</code>가 가리키는 위치입니다.</li>
</ul></div></div></div><div class="heading-wrapper"><h3 data-heading="코드 분석:" dir="auto" class="heading" id="코드_분석:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>코드 분석:</h3><div class="heading-children"><div><ol>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong><code>0x400000 | call 0x401000</code></strong></p>
<ul>
<li data-line="2" dir="auto"><code>rip = 0x400000</code>에서 <code>call</code> 명령어가 실행됩니다.</li>
<li data-line="3" dir="auto"><code>call</code> 명령어는 함수 호출을 의미하며, 현재 명령어의 다음 주소(<code>rip + 5 = 0x400005</code>)를 스택에 저장한 후, <strong><code>0x401000</code></strong>으로 점프합니다.</li>
<li data-line="4" dir="auto">이때 스택에 <strong>리턴 주소</strong> <code>0x400005</code>가 저장됩니다.</li>
</ul>
</li>
</ol></div><div><p dir="auto">스택 변화:</p></div><div><pre><code>rsp = rsp - 8
[rsp] = 0x400005 (리턴 주소)
</code><button class="copy-code-button">복사</button></pre></div><div><p dir="auto">새로운 스택 상태:</p></div><div><pre><code>0x7fffffffc3f8 | 0x400005  &lt;- 스택에 리턴 주소가 저장됨
0x7fffffffc400 | 0x0
rsp = 0x7fffffffc3f8

</code><button class="copy-code-button">복사</button></pre></div><div><ul>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong><code>0x400005 | mov esi, eax</code></strong></p>
<ul>
<li data-line="2" dir="auto">이 명령어는 원래 함수가 종료된 후에 실행될 명령어입니다. 하지만 <code>call</code>에 의해 점프되었기 때문에 바로 실행되지 않습니다.</li>
</ul>
</li>
<li data-line="3" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong><code>0x401000 | push rbp</code></strong></p>
<ul>
<li data-line="5" dir="auto"><code>rip</code>은 이제 <strong><code>0x401000</code></strong>을 가리키며, 새로운 함수가 시작됩니다.</li>
<li data-line="6" dir="auto"><code>push rbp</code>는 이전 프레임의 <strong>베이스 포인터</strong> <code>rbp</code>를 스택에 저장합니다.</li>
</ul>
</li>
<li data-line="8" dir="auto">
<p>스택 변화:</p>
</li>
</ul></div><div><pre><code>rsp = rsp - 8
[rsp] = rbp (이전 함수의 rbp 값 저장)
</code><button class="copy-code-button">복사</button></pre></div><div><p dir="auto">새로운 스택 상태:</p></div><div><pre><code>0x7fffffffc3f0 | 이전 rbp 값
0x7fffffffc3f8 | 0x400005  &lt;- 리턴 주소
rsp = 0x7fffffffc3f0
</code><button class="copy-code-button">복사</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="요약:" dir="auto" class="heading" id="요약:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>요약:</h3><div class="heading-children"><div><ul>
<li data-line="0" dir="auto"><code>call 0x401000</code> 명령어는 함수 호출을 발생시키며, 리턴 주소인 <code>0x400005</code>를 스택에 저장하고 <code>0x401000</code>으로 점프합니다.</li>
<li data-line="1" dir="auto">스택 포인터는 리턴 주소를 저장하면서 8바이트 감소합니다.</li>
<li data-line="2" dir="auto"><code>0x401000</code>에서 함수가 시작되며, <code>push rbp</code>로 이전 프레임의 <code>rbp</code>가 스택에 저장됩니다.</li>
</ul></div><div dir="ltr" style="overflow-x: auto;"><table>
<thead>
<tr>
<th dir="ltr"><strong>leave: 스택프레임 정리</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td dir="ltr"><strong>연산</strong>  <br><code>mov rsp, rbp</code>  <br><code>pop rbp</code></td>
</tr>
</tbody>
</table></div><div><div data-callout-metadata="" data-callout-fold="" data-callout="example" class="callout"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-list"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg></div><div class="callout-title-inner">Example</div></div></div></div><div><pre><code>[Register]
rsp = 0x7fffffffc400
rbp = 0x7fffffffc480

[Stack]
0x7fffffffc400 | 0x0 &lt;- rsp
...
0x7fffffffc480 | 0x7fffffffc500 &lt;- rbp
0x7fffffffc488 | 0x31337 

[Code]
leave
</code><button class="copy-code-button">복사</button></pre></div><div><p dir="auto">결과:</p></div><div><pre><code>[Register]
rsp = 0x7fffffffc488
rbp = 0x7fffffffc500

[Stack]
0x7fffffffc400 | 0x0
...
0x7fffffffc480 | 0x7fffffffc500
0x7fffffffc488 | 0x31337 &lt;- rsp
...
0x7fffffffc500 | 0x7fffffffc550 &lt;- rbp
</code><button class="copy-code-button">복사</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="과정 요약" dir="auto" class="heading" id="과정_요약"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>과정 요약</h3><div class="heading-children"><div><ol>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong><code>leave</code> 명령어 실행</strong>:
<ul>
<li data-line="1" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><code>leave</code> 명령어는 다음 두 작업을 수행합니다:
<ul>
<li data-line="2" dir="auto"><code>mov rsp, rbp</code>: 스택 포인터를 현재 베이스 포인터의 값으로 설정하여, 현재 함수의 스택 프레임을 종료합니다. 이때 <code>rsp</code>는 <code>0x7fffffffc480</code>에서 <code>0x7fffffffc488</code>으로 이동합니다.</li>
<li data-line="3" dir="auto"><code>pop rbp</code>: 스택에서 이전 <code>rbp</code> 값을 꺼내어 <code>rbp</code> 레지스터에 저장합니다. 이 과정에서 <code>rsp</code>는 다시 8바이트 증가하여 <code>0x7fffffffc488</code>이 됩니다.</li>
</ul>
</li>
</ul>
</li>
</ol></div></div></div><div class="heading-wrapper"><h3 data-heading="최종 상태" dir="auto" class="heading" id="최종_상태"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>최종 상태</h3><div class="heading-children"><div><ul>
<li data-line="0" dir="auto"><strong><code>rsp = 0x7fffffffc488</code></strong>: 현재 스택 포인터는 지역 변수 또는 스택의 다른 데이터를 가리키고 있습니다. 이 주소에는 <code>0x31337</code>가 저장되어 있습니다.</li>
<li data-line="1" dir="auto"><strong><code>rbp = 0x7fffffffc500</code></strong>: 이전 함수의 베이스 포인터 값으로 복원되었습니다.</li>
</ul></div></div></div><div class="heading-wrapper"><h3 data-heading="다음 단계" dir="auto" class="heading" id="다음_단계"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>다음 단계</h3><div class="heading-children"><div><ul>
<li data-line="0" dir="auto">이제 스택에서 리턴 주소를 꺼내 <code>ret</code> 명령어가 실행되면, 함수가 종료되고 호출된 함수로 복귀하게 됩니다. 스택에는 여전히 이전 <code>rbp</code> 값(<code>0x7fffffffc500</code>)이 남아 있어, 필요할 경우 이 값으로 다시 접근할 수 있습니다.</li>
</ul></div><div><p dir="auto">결과적으로, <code>leave</code> 명령어를 통해 스택 프레임을 정리하고 이전 함수의 상태로 안전하게 복귀할 준비가 완료되었습니다.</p></div><div dir="ltr" style="overflow-x: auto;"><table>
<thead>
<tr>
<th dir="ltr"><strong>ret : return address로 반환</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td dir="ltr"><strong>연산</strong>  <br><code>pop rip</code></td>
</tr>
</tbody>
</table></div><div><div data-callout-metadata="" data-callout-fold="" data-callout="example" class="callout"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-list"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg></div><div class="callout-title-inner">Example</div></div></div></div><div><pre><code>[Register]
rip = 0x401008
rsp = 0x7fffffffc3f8

[Stack]
0x7fffffffc3f8 | 0x400005    &lt;- rsp
0x7fffffffc400 | 0

[Code]
0x400000 | call 0x401000
0x400005 | mov esi, eax
...
0x401000 | mov rbp, rsp  
...
0x401007 | leave
0x401008 | ret  &lt;- rip
</code><button class="copy-code-button">복사</button></pre></div><div><p dir="auto">결과:</p></div><div><pre><code>[Register]
rip = 0x400005
rsp = 0x7fffffffc400

[Stack]
0x7fffffffc3f8 | 0x400005
0x7fffffffc400 | 0x0    &lt;- rsp

[Code]
0x400000 | call 0x401000
0x400005 | mov esi, eax   &lt;- rip
...
0x401000 | mov rbp, rsp  
...
0x401007 | leave
0x401008 | ret
</code><button class="copy-code-button">복사</button></pre></div><div dir="ltr" style="overflow-x: auto;"><table>
<thead>
<tr>
<th dir="ltr">💡스택프레임이란?</th>
</tr>
</thead>
<tbody>
<tr>
<td dir="ltr">스택은 함수별로 자신의 지역변수 또는 연산과정에서 부차적으로 생겨나는 임시 값들을 저장하는 영역입니다. 만약 이 스택 영역을 아무런 구분 없이 사용하게 된다면, 서로 다른 두 함수가 같은 메모리 영역을 사용할 수 있게 됩니다.</td>
</tr>
</tbody>
</table></div><div class="heading-wrapper"><h4 data-heading="Opcode: 시스템 콜📟" dir="auto" class="heading" id="Opcode:_시스템_콜📟"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Opcode: 시스템 콜📟</h4><div class="heading-children"><div><hr></div><div><p dir="auto">윈도우, 리눅스, 맥 등의 현대 운영체제는 컴퓨터 자원의 효율적인 사용을 위해, 그리고 사용자에게 편리한 경험을 제공하기 위해, 내부적으로 매우 복잡한 동작을 합니다. 운영체제는 연결된 모든 하드웨어 및 소프트웨어에 접근할 수 있으며, 이들을 제어할 수도 있습니다. 그리고 해킹으로부터 이 막강한 권한을 보호하기 위해 커널 모드와 유저 모드로 권한을 나눕니다.</p></div><div><p dir="auto"><span alt="Pasted image 20240923150626.png" src="Pasted image 20240923150626.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20240923150626.png" src="lib/media/pasted-image-20240923150626.png"></span></p></div><div><p dir="auto"><strong>커널 모드</strong>는 운영체제가 전체 시스템을 제어하기 위해 시스템 소프트웨어에 부여하는 권한입니다. 파일시스템, 입력/출력, 네트워크 통신, 메모리 관리 등 모든 저수준의 작업은 사용자 모르게 커널 모드에서 진행됩니다. 커널 모드에서는 시스템의 모든 부분을 제어할 수 있기 때문에, 해커가 커널 모드까지 진입하게 되면 시스템은 거의 무방비 상태가 됩니다.</p></div><div><p dir="auto"><strong>유저 모드</strong>는 운영체제가 사용자에게 부여하는 권한입니다. 브라우저를 이용하여 드림핵을 보거나, 유튜브를 시청하는 것, 게임을 하고 프로그래밍을 하는 것 등은 모두 유저 모드에서 이루어집니다. 리눅스에서 루트 권한으로 사용자를 추가하고, 패키지를 내려 받는 행위 등도 마찬가지입니다. 유저 모드에서는 해킹이 발생해도, 해커가 유저 모드의 권한까지 밖에 획득하지 못하기 때문에 해커로 부터 커널의 막강한 권한을 보호할 수 있습니다.</p></div><div><p dir="auto"><strong>시스템 콜(system call, syscall)</strong>은 유저 모드에서 커널 모드의 시스템 소프트웨어에게 어떤 동작을 요청하기 위해 사용됩니다. 소프트웨어 대부분은 커널의 도움이 필요합니다. 예를 들어, 사용자가 <code>cat flag</code>를 실행하면, cat은 flag라는 파일을 읽어서 사용자의 화면에 출력해 줘야 합니다. 그런데 flag는 파일 시스템에 존재하므로 이를 읽으려면 파일시스템에 접근할 수 있어야 합니다. 유저 모드에서는 이를 직접 할 수 없으므로 커널이 <strong>도움</strong>을 줘야 합니다. 여기서, 도움이 필요하다는 요청을 시스템 콜이라고 합니다. 유저 모드의 소프트웨어가 필요한 도움을 요청하면, 커널이 요청한 동작을 수행하여 유저에게 결과를 반환합니다.</p></div><div dir="ltr" style="overflow-x: auto;"><table>
<thead>
<tr>
<th dir="ltr"><strong>syscall</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td dir="ltr"><strong>요청:</strong> <code>rax</code><br><br><strong>인자 순서:</strong> <code>rdi -&gt; rsi -&gt; rdx -&gt; rcx -&gt; r8 -&gt; r9 -&gt; stack</code></td>
</tr>
</tbody>
</table></div><div><div data-callout-metadata="" data-callout-fold="" data-callout="example" class="callout"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-list"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg></div><div class="callout-title-inner">Example</div></div></div></div><div><pre><code>[Register]
rax = 0x1   
rdi = 0x1   
rsi = 0x401000  
rdx = 0xb   

[Memory]
0x401000 | "Hello Wo"   
0x401008 | "rld"    

[Code]  
syscall 
</code><button class="copy-code-button">복사</button></pre></div><div><p dir="auto">결과</p></div><div><pre><code>Hello World
</code><button class="copy-code-button">복사</button></pre></div><div><p dir="auto"><strong>해석</strong></p></div><div><p dir="auto">오른쪽의 syscall table을 보면, rax가 0x1일 때, 커널에 write 시스템콜을 요청합니다. 이때 rdi, rsi, rdx가 0x1, 0x401000, 0xb 이므로 커널은 write(0x1, 0x401000, 0xb)를 수행하게 됩니다.</p></div><div><p dir="auto">write함수의 각 인자는 출력 스트림, 출력 버퍼, 출력 길이를 나타냅니다. 여기서 0x1은 stdout이며, 이는 일반적으로 화면을 의미합니다. 0x401000에는 Hello World가 저장되어 있고, 길이는 0xb로 지정되어 있으므로, 화면에 Hello World가 출력됩니다.</p></div></div></div></div></div><div class="heading-wrapper"><h2 data-heading="x64 syscall 테이블" dir="auto" class="heading" id="x64_syscall_테이블"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>x64 syscall 테이블</h2><div class="heading-children"><div><p dir="auto">이하는 시스템 콜 테이블의 일부입니다. 총 갯수가 300개에 달하고, 검색하면 쉽게 찾을 수 있으므로 외울 필요는 없습니다. 나중에 셸코딩을 하다보면 자연스럽게 중요한 몇 가지는 익숙해질 것입니다.</p></div><div dir="auto" style="overflow-x: auto;"><table>
<thead>
<tr>
<th dir="auto"></th>
<th dir="auto"></th>
<th dir="auto"></th>
<th dir="auto"></th>
<th dir="auto"></th>
</tr>
</thead>
<tbody>
<tr>
<td dir="ltr"><strong>syscall</strong></td>
<td dir="ltr"><strong>rax</strong></td>
<td dir="ltr"><strong>arg0&nbsp;(rdi)</strong></td>
<td dir="ltr"><strong>arg1&nbsp;(rsi)</strong></td>
<td dir="ltr"><strong>arg2&nbsp;(rdx)</strong></td>
</tr>
<tr>
<td dir="ltr">read</td>
<td dir="ltr">0x00</td>
<td dir="ltr">unsigned int fd</td>
<td dir="ltr">char *buf</td>
<td dir="ltr">size_t count</td>
</tr>
<tr>
<td dir="ltr">write</td>
<td dir="ltr">0x01</td>
<td dir="ltr">unsigned int fd</td>
<td dir="ltr">const char *buf</td>
<td dir="ltr">size_t count</td>
</tr>
<tr>
<td dir="ltr">open</td>
<td dir="ltr">0x02</td>
<td dir="ltr">const char *filename</td>
<td dir="ltr">int flags</td>
<td dir="ltr">umode_t mode</td>
</tr>
<tr>
<td dir="ltr">close</td>
<td dir="ltr">0x03</td>
<td dir="ltr">unsigned int fd</td>
<td dir="auto"></td>
<td dir="auto"></td>
</tr>
<tr>
<td dir="ltr">mprotect</td>
<td dir="ltr">0x0a</td>
<td dir="ltr">unsigned long start</td>
<td dir="ltr">size_t len</td>
<td dir="ltr">unsigned long prot</td>
</tr>
<tr>
<td dir="ltr">connect</td>
<td dir="ltr">0x2a</td>
<td dir="ltr">int sockfd</td>
<td dir="ltr">struct sockaddr * addr</td>
<td dir="ltr">int addrlen</td>
</tr>
<tr>
<td dir="ltr">execve</td>
<td dir="ltr">0x3b</td>
<td dir="ltr">const char *filename</td>
<td dir="ltr">const char <em>const </em>argv</td>
<td dir="ltr">const char <em>const </em>envp</td>
</tr>
</tbody>
</table></div><div class="heading-wrapper"><h3 data-heading="Epilogue" dir="auto" class="heading" id="Epilogue"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Epilogue</h3><div class="heading-children"><div><hr></div><div><ol>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>스택</strong></p>
<ul>
<li data-line="2" dir="auto"><code>push val</code>: rsp를 8만큼 빼고, 스택의 최상단에 val을 쌓습니다.<br>
</li>
<li data-line="4" dir="auto"><code>pop reg</code>: 스택 최상단의 값을 reg에 넣고, rsp를 8만큼 더합니다.<br>
</li>
</ul>
</li>
<li data-line="6" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>프로시저</strong></p>
<ul>
<li data-line="8" dir="auto"><code>call addr</code>: addr의 프로시저를 호출합니다.<br>
</li>
<li data-line="10" dir="auto"><code>leave</code>: 스택 프레임을 정리합니다.<br>
</li>
<li data-line="12" dir="auto"><code>ret</code>: 호출자의 실행 흐름으로 돌아갑니다.<br>
</li>
</ul>
</li>
<li data-line="14" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>시스템 콜</strong></p>
<ul>
<li data-line="16" dir="auto"><code>syscall</code>: 커널에게 필요한 동작을 요청합니다.</li>
</ul>
</li>
</ol></div><div><blockquote dir="auto">
<p>[Tip] 레지스터 종류들 </p>
</blockquote></div><div class="heading-wrapper"><h4 data-heading="범용 레지스터" dir="auto" class="heading" id="범용_레지스터"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>범용 레지스터</h4><div class="heading-children"><div><hr></div><div dir="ltr" style="overflow-x: auto;"><table>
<thead>
<tr>
<th dir="ltr"><strong>이름</strong></th>
<th dir="ltr"><strong>주용도</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td dir="ltr">rax (accumulator register)</td>
<td dir="ltr">함수의 반환 값</td>
</tr>
<tr>
<td dir="ltr">rbx (base register)</td>
<td dir="ltr">x64에서는 주된 용도 없음</td>
</tr>
<tr>
<td dir="ltr">rcx (counter register)</td>
<td dir="ltr">반복문의 반복 횟수, 각종 연산의 시행 횟수</td>
</tr>
<tr>
<td dir="ltr">rdx (data register)</td>
<td dir="ltr">x64에서는 주된 용도 없음</td>
</tr>
<tr>
<td dir="ltr">rsi (source index)</td>
<td dir="ltr">데이터를 옮길 때 원본을 가리키는 포인터</td>
</tr>
<tr>
<td dir="ltr">rdi (destination index)</td>
<td dir="ltr">데이터를 옮길 때 목적지를 가리키는 포인터</td>
</tr>
<tr>
<td dir="ltr">rsp (stack pointer)</td>
<td dir="ltr">사용중인 스택의 위치를 가리키는 포인터</td>
</tr>
<tr>
<td dir="ltr">rbp (stack base pointer)</td>
<td dir="ltr">스택의 바닥을 가리키는 포인터</td>
</tr>
</tbody>
</table></div></div></div></div></div></div></div><div class="heading-wrapper"><h2 data-heading="플래그 레지스터 🏳️🏴" dir="auto" class="heading" id="플래그_레지스터_🏳️🏴"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>플래그 레지스터 🏳️🏴</h2><div class="heading-children"><div><p dir="auto">플래그 레지스터는 프로세서의 현재 상태를 저장하고 있는 레지스터입니다. x64 아키텍처에서는 RFLAGS라고 불리는 64비트 크기의 플래그 레지스터가 존재하며, 과거 16비트 플래그 레지스터가 확장된 것입니다. 깃발을 올리고, 내리는 행위 로 신호를 전달하듯, 플래그 레지스터는 자신을 구성하는 여러 비트들로 CPU의 현재 상태를 표현합니다.</p></div><div><p dir="auto">RFLAGS는 64비트이므로 최대 64개의 플래그를 사용할 수 있지만, 실제로는 아래 그림의 20여개의 비트만 사용합니다. 그리고 그 중에서도 여러분이 앞으로 주로 접하게 될 것들은 그림 아래의 표와 같습니다.</p></div><div><p dir="auto"><strong>플래그</strong></p></div><div><p dir="auto"><strong>의미</strong></p></div><div><p dir="auto">CF(Carry Flag)</p></div><div><p dir="auto">부호 없는 수의 연산 결과가 비트의 범위를 넘을 경우 설정 됩니다.</p></div><div><p dir="auto">ZF(Zero Flag)</p></div><div><p dir="auto">연산의 결과가 0일 경우 설정 됩니다.</p></div><div><p dir="auto">SF(Sign Flag)</p></div><div><p dir="auto">연산의 결과가 음수일 경우 설정 됩니다.</p></div><div><p dir="auto">OF(Overflow Flag)</p></div><div><p dir="auto">부호 있는 수의 연산 결과가 비트 범위를 넘을 경우 설정 됩니다.</p></div></div></div><div class="heading-wrapper"><h2 data-heading="레지스터 호환" dir="auto" class="heading" id="레지스터_호환"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>레지스터 호환</h2><div class="heading-children"><div><p dir="auto">앞에서 x86-64 아키텍처는 IA-32의 64비트 확장 아키텍처이며, 호환이 가능하다고 했습니다. IA-32에서 CPU의 레지스터들은 32비트 크기를 가지며, 이들의 명칭은 각각 <em>eax, ebx, ecx, edx, esi, edi, esp, ebp</em>였습니다. 호환성을 위해 이 레지스터들은 x86-64에서도 그대로 사용이 가능합니다.</p></div><div><p dir="auto">앞서 소개드린 <em>rax, rbx, rcx, rdx, rsi, rdi, rsp, rbp</em>가 이들의 확장된 형태이며, eax, ebx 등은 확장된 레지스터의 하위 32비트를 가리킵니다. 예를 들어, <em>eax</em>는 <em>rax</em>의 하위 32비트를 의미합니다.</p></div><div><p dir="auto">또한 마찬가지로 과거 16비트 아키텍처인 IA-16과의 호환을 위해 <em>ax, bx, cx, dx, si, di, sp, bp</em>는 <em>eax, ebx , ecx , edx, esi, edi, esp, ebp</em>의 하위 16비트를 가리킵니다.</p></div><div><p dir="auto">이들 중 몇몇은 다시 상위 8비트, 하위 8비트로 나뉘는데 이들 전체에 대한 내용은 하단의 그림에서 확인할 수 있습니다.</p></div><div><p dir="auto">x86-64의 레지스터</p></div><div><p dir="auto"><img src="https://dreamhack-lecture.s3.amazonaws.com/media/e8a11199560c67d332f1dc11b94acd14dc84a72bf93d6ce921909f02622a1320.png" referrerpolicy="no-referrer"></p></div><div><ul>
<li data-line="0" dir="auto">
<p><strong>범용 레지스터(General Register)</strong>: 주 용도는 있으나, 그 외의 용도로도 자유롭게 사용할 수 있는 레지스터. x64에는 <em>rax, rbx, rcx, rdx, rsi, rdi, rsp, rbp, r8-r15</em>가 있다.</p>
</li>
<li data-line="3" dir="auto">
<p><strong>세그먼트 레지스터(Segment Register)</strong>: 과거에는 메모리 세그멘테이션이나, 가용 메모리 공간의 확장을 위해 사용됐으나, 현재는 주로 메모리 보호를 위해 사용되는 레지스터. x64에는 <em>cs, ss, ds, es, fs, gs</em>가 있다.</p>
</li>
<li data-line="6" dir="auto">
<p><strong>플래그 레지스터(Flag Register)</strong>: CPU의 상태를 저장하는 레지스터</p>
</li>
<li data-line="9" dir="auto">
<p><strong>명령어 포인터 레지스터(Instruction Pointer Register, IP)</strong>: CPU가 실행해야할 코드를 가리키는 레지스터. x64에서는 <em>rip</em>가 있다.</p>
</li>
</ul></div><div class="mod-footer"></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button is-collapsed" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="achive\dreamhack\시스템-해킹\x86-64-어셈블리-명령어-pt.2.html#x86-64 어셈블리 명령어 Pt.2"><div class="tree-item-contents heading-link" heading-name="x86-64 어셈블리 명령어 Pt.2"><span class="tree-item-title">x86-64 어셈블리 명령어 Pt.2</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="4"><a class="tree-link" href="achive\dreamhack\시스템-해킹\x86-64-어셈블리-명령어-pt.2.html#Opcode:_스택🧱"><div class="tree-item-contents heading-link" heading-name="Opcode: 스택🧱"><span class="tree-item-title">Opcode: 스택🧱</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="achive\dreamhack\시스템-해킹\x86-64-어셈블리-명령어-pt.2.html#Opcode:_프로시저📜"><div class="tree-item-contents heading-link" heading-name="Opcode: 프로시저📜"><span class="tree-item-title">Opcode: 프로시저📜</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="achive\dreamhack\시스템-해킹\x86-64-어셈블리-명령어-pt.2.html#레지스터_상태:"><div class="tree-item-contents heading-link" heading-name="레지스터 상태:"><span class="tree-item-title">레지스터 상태:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="achive\dreamhack\시스템-해킹\x86-64-어셈블리-명령어-pt.2.html#스택_상태:"><div class="tree-item-contents heading-link" heading-name="스택 상태:"><span class="tree-item-title">스택 상태:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="achive\dreamhack\시스템-해킹\x86-64-어셈블리-명령어-pt.2.html#코드_분석:"><div class="tree-item-contents heading-link" heading-name="코드 분석:"><span class="tree-item-title">코드 분석:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="achive\dreamhack\시스템-해킹\x86-64-어셈블리-명령어-pt.2.html#요약:"><div class="tree-item-contents heading-link" heading-name="요약:"><span class="tree-item-title">요약:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="achive\dreamhack\시스템-해킹\x86-64-어셈블리-명령어-pt.2.html#과정_요약"><div class="tree-item-contents heading-link" heading-name="과정 요약"><span class="tree-item-title">과정 요약</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="achive\dreamhack\시스템-해킹\x86-64-어셈블리-명령어-pt.2.html#최종_상태"><div class="tree-item-contents heading-link" heading-name="최종 상태"><span class="tree-item-title">최종 상태</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="achive\dreamhack\시스템-해킹\x86-64-어셈블리-명령어-pt.2.html#다음_단계"><div class="tree-item-contents heading-link" heading-name="다음 단계"><span class="tree-item-title">다음 단계</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="achive\dreamhack\시스템-해킹\x86-64-어셈블리-명령어-pt.2.html#Opcode:_시스템_콜📟"><div class="tree-item-contents heading-link" heading-name="Opcode: 시스템 콜📟"><span class="tree-item-title">Opcode: 시스템 콜📟</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item mod-collapsible is-collapsed" data-depth="2"><a class="tree-link" href="achive\dreamhack\시스템-해킹\x86-64-어셈블리-명령어-pt.2.html#x64_syscall_테이블"><div class="tree-item-contents heading-link" heading-name="x64 syscall 테이블"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">x64 syscall 테이블</span></div></a><div class="tree-item-children nav-folder-children" style="display: none;"><div class="tree-item mod-collapsible is-collapsed" data-depth="3"><a class="tree-link" href="achive\dreamhack\시스템-해킹\x86-64-어셈블리-명령어-pt.2.html#Epilogue"><div class="tree-item-contents heading-link" heading-name="Epilogue"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Epilogue</span></div></a><div class="tree-item-children nav-folder-children" style="display: none;"><div class="tree-item" data-depth="4"><a class="tree-link" href="achive\dreamhack\시스템-해킹\x86-64-어셈블리-명령어-pt.2.html#범용_레지스터"><div class="tree-item-contents heading-link" heading-name="범용 레지스터"><span class="tree-item-title">범용 레지스터</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="achive\dreamhack\시스템-해킹\x86-64-어셈블리-명령어-pt.2.html#플래그_레지스터_🏳️🏴"><div class="tree-item-contents heading-link" heading-name="플래그 레지스터 🏳️🏴"><span class="tree-item-title">플래그 레지스터 🏳️🏴</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="achive\dreamhack\시스템-해킹\x86-64-어셈블리-명령어-pt.2.html#레지스터_호환"><div class="tree-item-contents heading-link" heading-name="레지스터 호환"><span class="tree-item-title">레지스터 호환</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>