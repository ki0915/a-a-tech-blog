<!DOCTYPE html> <html><head>
		<title>8. Command Injection</title>
		<base href="..\..\..\..\../">
		<meta id="root-path" root-path="..\..\..\..\../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="Obsidian Vault - 8. Command Injection">
		<meta property="og:title" content="8. Command Injection">
		<meta property="og:description" content="Obsidian Vault - 8. Command Injection">
		<meta property="og:type" content="website">
		<meta property="og:url" content="achive/tryhackme/jr-penetration-tester/웹-해킹-소개/eng/8.-command-injection.html">
		<meta property="og:image" content="https://blog.kakaocdn.net/dn/c0I1Mn/btsiX2sdf2L/HMzh7aoTMHLuCLohuoqgP1/img.png">
		<meta property="og:site_name" content="Obsidian Vault">
		<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="lib/scripts/pixi.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="lib/scripts/minisearch.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><include src="lib/html/custom-head-content.html"></include><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="preload" href="lib/styles/other-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/other-plugins.css"></noscript><link rel="stylesheet" href="lib/styles/theme.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript><link rel="preload" href="lib/styles/snippets.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/snippets.css"></noscript></head><body class="publish css-settings-manager theme-dark show-inline-title show-ribbon ctp-latte ctp-mocha ctp-accent-rosewater anuppuccin-accent-toggle anp-h1-red anp-h2-peach anp-h3-green anp-h4-teal anp-h5-lavender anp-h6-mauve anp-bold-red anp-italic-green anp-highlight-yellow"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="8. Command Injection"><ol start="8">
<li dir="auto">Command Injection</li>
</ol></h1><div><div data-callout-metadata="" data-callout-fold="" data-callout="abstract" class="callout"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-clipboard-list"><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><path d="M12 11h4"></path><path d="M12 16h4"></path><path d="M8 11h.01"></path><path d="M8 16h.01"></path></svg></div><div class="callout-title-inner heading-wrapper"><h2 data-heading="What is Command Injection?" dir="auto" class="heading" id="What_is_Command_Injection?"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>What is Command Injection?</h2><div class="heading-children"></div></div></div></div></div><div><p dir="auto">In this session, we will explore the web vulnerability known as command injection. After understanding what this vulnerability is, we will demonstrate its impact and the risks it poses to applications.</p></div><div><ul>
<li data-line="0" dir="auto">How to identify command injection vulnerabilities</li>
<li data-line="1" dir="auto">How to test and exploit these vulnerabilities using payloads designed for various operating systems</li>
<li data-line="2" dir="auto">How to prevent command injection vulnerabilities in applications</li>
<li data-line="3" dir="auto">Finally, you will apply the theory to practice in the hands-on exercise at the end of the session.</li>
</ul></div><div><p dir="auto">First, let's understand what command injection is. Command injection is an exploitation of an application's behavior to execute commands on the operating system with the same privileges as the application is running. For example, if command injection is performed on a web server running under a user named "joe," the commands will be executed under the "joe" user, gaining all the permissions that the "joe" user has.</p></div><div><p dir="auto">Command injection vulnerabilities are also known as "Remote Code Execution" (RCE) because attackers can trick the application into executing a series of payloads that ultimately allow them to run commands on the system without direct access (e.g., through an interactive shell). The web server processes this code and executes it according to the permissions and access controls of the user running the application.</p></div><div><p dir="auto">Command injection is also referred to as "Remote Code Execution" (RCE) because it allows for remote execution of code within the application. These vulnerabilities are often most advantageous to attackers because they imply that the attacker can interact directly with the vulnerable system. For example, attackers may be able to read system or user files, data, and other similar items.</p></div><div><p dir="auto">For example, using command injection to abuse an application to run a command like <code>whoami</code> to list the user account under which the application is running is a classic example of command injection.</p></div><div><p dir="auto">Command injection was listed as one of the top 10 vulnerabilities in the 2019 Contrast Security AppSec Intelligence Report (<a data-tooltip-position="top" aria-label="https://www.contrastsecurity.com/security-influencers/insights-appsec-intelligence-report" rel="noopener" class="external-link" href="https://www.contrastsecurity.com/security-influencers/insights-appsec-intelligence-report" target="_blank">Contrast Security AppSec., 2019</a>). The OWASP framework also consistently includes such vulnerabilities as one of the top 10 in web applications (<a data-tooltip-position="top" aria-label="https://owasp.org/www-project-top-ten/" rel="noopener" class="external-link" href="https://owasp.org/www-project-top-ten/" target="_blank">OWASP Framework</a>).</p></div><div class="heading-wrapper"><h4 data-heading="Understanding Command Injection" dir="auto" class="heading" id="Understanding_Command_Injection"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Understanding Command Injection</h4><div class="heading-children"><div><hr></div><div><p dir="auto">This vulnerability exists because applications often use functions from programming languages like PHP, Python, and NodeJS to pass data to the system operating system and make system calls. For example, they might receive input from a field and search for items in a file. Let's look at a code snippet to illustrate this.</p></div><div><p dir="auto">In this code snippet, the application retrieves data entered by the user in a field named <code>$title</code> and searches for directories related to song titles. Let's break this down into a few simple steps.</p></div><div><p dir="auto"><img src="https://blog.kakaocdn.net/dn/c0I1Mn/btsiX2sdf2L/HMzh7aoTMHLuCLohuoqgP1/img.png" referrerpolicy="no-referrer"></p></div><div><blockquote dir="auto">
<p>Process</p>
</blockquote></div><div><p dir="auto"><strong>1.</strong> The application stores MP3 files in directories included in the operating system.</p></div><div><p dir="auto"><strong>2.</strong> The user inputs the song title they want to search. The application stores this input in the <code>$title</code> variable.</p></div><div><p dir="auto"><strong>3.</strong> The data in this variable is passed to a command <code>$title</code> that searches for a text file called <code>songtitle.txt</code> for the item the user wants to search for. <code>_grep</code></p></div><div><p dir="auto"><strong>4.</strong> The search result of the song title in the <code>_.txt_</code> determines whether the application informs the user whether the song exists.</p></div><div><p dir="auto">This kind of information is generally stored in a database. However, this is an example of a case where an application receives input from a user to interact with the application’s operating system.</p></div><div><p dir="auto">Attackers can exploit this application by injecting their own commands to have the application execute them. Instead of using <code>grep</code> to search for items in <code>songtitle.txt</code>, they might request the application to read data from more sensitive files.</p></div><div><p dir="auto">Exploiting applications in this manner can occur regardless of the programming language used. Command injection can occur as long as the application processes and executes commands. For example, consider the following code</p></div><div><p dir="auto">4o mini</p></div><div class="heading-wrapper"><h5 data-heading="나의 말:" dir="auto" class="heading" id="나의_말:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>나의 말:</h5><div class="heading-children"><div><p dir="auto">다시 생성해줘 중간에 짤렸어</p></div></div></div><div class="heading-wrapper"><h5 data-heading="ChatGPT의 말:" dir="auto" class="heading" id="ChatGPT의_말:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>ChatGPT의 말:</h5><div class="heading-children"><div><p dir="auto">ChatGPT</p></div><div><div data-callout-metadata="" data-callout-fold="" data-callout="abstract" class="callout"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-clipboard-list"><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><path d="M12 11h4"></path><path d="M12 16h4"></path><path d="M8 11h.01"></path><path d="M8 16h.01"></path></svg></div><div class="callout-title-inner heading-wrapper"><h2 data-heading="What is Command Injection?" dir="auto" class="heading" id="What_is_Command_Injection?"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>What is Command Injection?</h2><div class="heading-children"></div></div></div></div></div><div><p dir="auto">In this session, we will explore the web vulnerability known as command injection. After understanding what this vulnerability is, we will demonstrate its impact and the risks it poses to applications.</p></div><div><ul>
<li data-line="0" dir="auto">How to identify command injection vulnerabilities</li>
<li data-line="1" dir="auto">How to test and exploit these vulnerabilities using payloads designed for various operating systems</li>
<li data-line="2" dir="auto">How to prevent command injection vulnerabilities in applications</li>
<li data-line="3" dir="auto">Finally, you will apply the theory to practice in the hands-on exercise at the end of the session.</li>
</ul></div><div><p dir="auto">First, let's understand what command injection is. Command injection is an exploitation of an application's behavior to execute commands on the operating system with the same privileges as the application is running. For example, if command injection is performed on a web server running under a user named "joe," the commands will be executed under the "joe" user, gaining all the permissions that the "joe" user has.</p></div><div><p dir="auto">Command injection vulnerabilities are also known as "Remote Code Execution" (RCE) because attackers can trick the application into executing a series of payloads that ultimately allow them to run commands on the system without direct access (e.g., through an interactive shell). The web server processes this code and executes it according to the permissions and access controls of the user running the application.</p></div><div><p dir="auto">Command injection is also referred to as "Remote Code Execution" (RCE) because it allows for remote execution of code within the application. These vulnerabilities are often most advantageous to attackers because they imply that the attacker can interact directly with the vulnerable system. For example, attackers may be able to read system or user files, data, and other similar items.</p></div><div><p dir="auto">For example, using command injection to abuse an application to run a command like <code>whoami</code> to list the user account under which the application is running is a classic example of command injection.</p></div><div><p dir="auto">Command injection was listed as one of the top 10 vulnerabilities in the 2019 Contrast Security AppSec Intelligence Report (<a data-tooltip-position="top" aria-label="https://www.contrastsecurity.com/security-influencers/insights-appsec-intelligence-report" rel="noopener" class="external-link" href="https://www.contrastsecurity.com/security-influencers/insights-appsec-intelligence-report" target="_blank">Contrast Security AppSec., 2019</a>). The OWASP framework also consistently includes such vulnerabilities as one of the top 10 in web applications (<a data-tooltip-position="top" aria-label="https://owasp.org/www-project-top-ten/" rel="noopener" class="external-link" href="https://owasp.org/www-project-top-ten/" target="_blank">OWASP Framework</a>).</p></div></div></div></div></div><div class="heading-wrapper"><h4 data-heading="Understanding Command Injection" dir="auto" class="heading" id="Understanding_Command_Injection"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Understanding Command Injection</h4><div class="heading-children"><div><hr></div><div><p dir="auto">This vulnerability exists because applications often use functions from programming languages like PHP, Python, and NodeJS to pass data to the system operating system and make system calls. For example, they might receive input from a field and search for items in a file. Let's look at a code snippet to illustrate this.</p></div><div><p dir="auto">In this code snippet, the application retrieves data entered by the user in a field named <code>$title</code> and searches for directories related to song titles. Let's break this down into a few simple steps.</p></div><div><p dir="auto"><img src="https://blog.kakaocdn.net/dn/c0I1Mn/btsiX2sdf2L/HMzh7aoTMHLuCLohuoqgP1/img.png" referrerpolicy="no-referrer"></p></div><div><blockquote dir="auto">
<p>Process</p>
</blockquote></div><div><p dir="auto"><strong>1.</strong> The application stores MP3 files in directories included in the operating system.</p></div><div><p dir="auto"><strong>2.</strong> The user inputs the song title they want to search. The application stores this input in the <code>$title</code> variable.</p></div><div><p dir="auto"><strong>3.</strong> The data in this variable is passed to a command <code>$title</code> that searches for a text file called <code>songtitle.txt</code> for the item the user wants to search for. <code>_grep</code></p></div><div><p dir="auto"><strong>4.</strong> The search result of the song title in the <code>_.txt_</code> determines whether the application informs the user whether the song exists.</p></div><div><p dir="auto">This kind of information is generally stored in a database. However, this is an example of a case where an application receives input from a user to interact with the application’s operating system.</p></div><div><p dir="auto">Attackers can exploit this application by injecting their own commands to have the application execute them. Instead of using <code>grep</code> to search for items in <code>songtitle.txt</code>, they might request the application to read data from more sensitive files.</p></div><div><p dir="auto">Exploiting applications in this manner can occur regardless of the programming language used. Command injection can occur as long as the application processes and executes commands. For example, consider the following code snippet written in Python.</p></div><div><p dir="auto"><img src="https://blog.kakaocdn.net/dn/Bar9x/btsiPPAI8JV/Kp1gdIDD5KTb6gkUuONUo1/img.png" referrerpolicy="no-referrer"></p></div><div><p dir="auto">Understanding the syntax of these applications is not required, but the steps of how this Python application works are briefly explained.</p></div><div><ol>
<li data-line="0" dir="auto">The "flask" package is used to set up the web server.</li>
<li data-line="1" dir="auto">The "subprocess" package provides the functionality to execute commands on the device.</li>
<li data-line="2" dir="auto">The web server uses the provided path to execute everything. For example, to run <code>whoami</code>, one would visit <a rel="noopener" class="external-link" href="http://flaskapp.thm/whoami" target="_blank">http://flaskapp.thm/whoami</a>.</li>
</ol></div></div></div><div class="heading-wrapper"><h4 data-heading="Exploiting Command Injection" dir="auto" class="heading" id="Exploiting_Command_Injection"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Exploiting Command Injection</h4><div class="heading-children"><div><hr></div><div><p dir="auto">As you will see in the hands-on session of this room, it is often possible to determine whether command injection can occur due to the application's behavior.</p></div><div><p dir="auto">Applications that use user input to fill system commands are often susceptible to unintended behavior. <strong>For example</strong>, <strong>shell operators</strong> such as <strong>;</strong> (or more) can combine system commands using <strong>&amp;</strong> and <strong>&amp;&amp;</strong> to execute both.</p></div><div><p dir="auto">Command injection can typically be detected in one of the following two ways:</p></div><div><ol>
<li data-line="0" dir="auto">Blind Command Injection</li>
<li data-line="1" dir="auto">Verbose Command Injection</li>
</ol></div><div><p dir="auto">The table below defines these two methods and explains them in detail in the following sections.</p></div><div><blockquote dir="auto">
<p>Table</p>
</blockquote></div><div dir="auto" style="overflow-x: auto;"><table>
<thead>
<tr>
<th dir="auto"></th>
<th dir="auto"></th>
</tr>
</thead>
<tbody>
<tr>
<td dir="ltr"><strong>Method</strong></td>
<td dir="ltr"><strong>Description</strong></td>
</tr>
<tr>
<td dir="ltr">Blind</td>
<td dir="ltr">This type of injection occurs when there is no direct output from the application while testing the payload. To determine if the payload is successful, you need to investigate the application's behavior.</td>
</tr>
<tr>
<td dir="ltr">Verbose</td>
<td dir="ltr">This type of injection occurs when there is direct feedback from the application after testing the payload. For example, executing a command like <code>whoami</code> to check the user under which the application is running, and the web application directly outputs the user name on the page.</td>
</tr>
</tbody>
</table></div><div><blockquote dir="auto">
<p>Detecting Blind Command Injection</p>
</blockquote></div><div><p dir="auto">Blind command injection is when command injection occurs, but the output is not immediately visible due to the lack of displayed output. For example, the command might execute, but the web application does not display a message.</p></div><div><p dir="auto">To detect this type of command injection, you should use payloads that induce some time delay. For example, the <code>ping</code> and <code>sleep</code> commands are useful payloads for testing. For instance, the <code>ping</code> command will cause the application to pause for a number of <em>seconds</em> related to the <em>ping</em> count specified.</p></div><div><p dir="auto">Another way to detect blind command injection is to force some output. This can be done using redirection operators like <code>&gt;</code> and <code>&lt;</code>. For example, you can execute a command on the web application that redirects <code>whoami</code> to a file, and then use a command like <code>cat</code> to read the contents of the newly created file.</p></div><div><p dir="auto">Testing command injection in this way can be complex and often requires a lot of experimentation due to differences in command syntax between Linux and Windows.</p></div><div><p dir="auto">The <code>curl</code> command is a good method for testing command injection because it can be used to pass data between applications. For example, a simple <code>curl</code> payload can be used for command injection:</p></div><div><p dir="auto"><code>curl [http://vulnerable.app/process.php%3Fsearch%3DThe%20Beatles%3B%20whoami](http://vulnerable.app/process.php%3Fsearch%3DThe%20Beatles%3B%20whoami)</code></p></div><div><blockquote dir="auto">
<p>Detecting Verbose Command Injection</p>
</blockquote></div><div><p dir="auto">Detecting command injection in this way is undoubtedly the easiest of the two methods. Verbose command injection occurs when the application provides feedback or output about the action or process occurring or running.</p></div><div><p dir="auto">For example, the output of commands like <code>ping</code> or <code>whoami</code> is directly displayed on the web application.</p></div><div><blockquote dir="auto">
<p>Useful Payloads</p>
</blockquote></div><div><p dir="auto">Below is a compilation of several important payloads for both Linux and Windows.</p></div><div><blockquote dir="auto">
<p>Linux</p>
</blockquote></div><div dir="auto" style="overflow-x: auto;"><table>
<thead>
<tr>
<th dir="auto"></th>
<th dir="auto"></th>
</tr>
</thead>
<tbody>
<tr>
<td dir="ltr"><strong>Payload</strong></td>
<td dir="ltr"><strong>Description</strong></td>
</tr>
<tr>
<td dir="ltr">whoami</td>
<td dir="ltr">Checks which user the application is running under.</td>
</tr>
<tr>
<td dir="ltr">ls</td>
<td dir="ltr">Lists the contents of the current directory. This can help find configuration files, environment files (tokens and application keys), and other important items.</td>
</tr>
<tr>
<td dir="ltr">ping</td>
<td dir="ltr">Calls this command to pause the application. This is useful for testing applications for blind command injection.</td>
</tr>
<tr>
<td dir="ltr">sleep</td>
<td dir="ltr">Another useful payload for testing applications for blind command injection where <code>ping</code> is not available.</td>
</tr>
<tr>
<td dir="ltr">nc</td>
<td dir="ltr">Can use Netcat to create a reverse shell on the vulnerable application. This foothold can be used to explore other services, files, or potential privilege escalation methods on the target computer.</td>
</tr>
</tbody>
</table></div><div><blockquote dir="auto">
<p>Windows</p>
</blockquote></div><div dir="auto" style="overflow-x: auto;"><table>
<thead>
<tr>
<th dir="auto"></th>
<th dir="auto"></th>
</tr>
</thead>
<tbody>
<tr>
<td dir="ltr"><strong>Payload</strong></td>
<td dir="ltr"><strong>Description</strong></td>
</tr>
<tr>
<td dir="ltr">whoami</td>
<td dir="ltr">Checks which user the application is running under.</td>
</tr>
<tr>
<td dir="ltr">dir</td>
<td dir="ltr">Lists the contents of the current directory. This can help find configuration files, environment files (tokens and application keys), and other important items.</td>
</tr>
<tr>
<td dir="ltr">ping</td>
<td dir="ltr">Calls this command to pause the application. This is useful for testing applications for blind command injection.</td>
</tr>
<tr>
<td dir="ltr">timeout</td>
<td dir="ltr">Also calls this command to pause the application. Useful for testing applications for blind command injection where <code>ping</code> is not available.</td>
</tr>
</tbody>
</table></div></div></div><div class="heading-wrapper"><h4 data-heading="Mitigating Command Injection" dir="auto" class="heading" id="Mitigating_Command_Injection"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Mitigating Command Injection</h4><div class="heading-children"><div><hr></div><div><p dir="auto">Command injection can be prevented in various ways. From minimizing the use of potentially dangerous functions or libraries in programming languages to filtering inputs without relying on user input. Below are some more detailed explanations. The examples below are in PHP, but the same principles can be extended to many other languages.</p></div><div><blockquote dir="auto">
<p><strong>Vulnerable Functions</strong></p>
</blockquote></div><div><p dir="auto">In PHP, many functions interact with the operating system and execute commands via the shell. These include:</p></div><div><ul>
<li data-line="0" dir="auto"><code>exec</code></li>
<li data-line="1" dir="auto"><code>passthru</code></li>
<li data-line="2" dir="auto"><code>system</code></li>
</ul></div><div><p dir="auto">Consider the snippet below where the user input is directly used in the command. This is a classic example of vulnerability:</p></div><div><p dir="auto">php</p></div><div><p dir="auto">코드 복사</p></div><div><p dir="auto"><code>&lt;?php   $title = $_GET['title'];   system("grep " . escapeshellarg($title) . " songtitle.txt"); ?&gt;</code></p></div><div><blockquote dir="auto">
<p><strong>Prevention</strong></p>
</blockquote></div><div><p dir="auto">To prevent command injection:</p></div><div><ol>
<li data-line="0" dir="auto"><strong>Validate Inputs</strong>: Ensure all input is validated and sanitized. Only allow a specific format or set of characters that the input can contain.</li>
<li data-line="1" dir="auto"><strong>Use Safe Functions</strong>: Where possible, use functions that do not execute system commands. For example, use <code>mysqli</code> or <code>PDO</code> for database queries instead of concatenating user inputs into system commands.</li>
<li data-line="2" dir="auto"><strong>Escaping</strong>: Use escaping functions specific to the programming language and environment. For example, in PHP, use <code>escapeshellarg()</code> to escape arguments passed to shell commands.</li>
</ol></div></div></div><div class="heading-wrapper"><h4 data-heading="Practical Exercise" dir="auto" class="heading" id="Practical_Exercise"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Practical Exercise</h4><div class="heading-children"><div><hr></div><div><p dir="auto">At the end of the session, you will apply your knowledge in a practical exercise. This hands-on task will involve identifying and exploiting command injection vulnerabilities in a controlled environment. You will:</p></div><div><ol>
<li data-line="0" dir="auto"><strong>Identify Vulnerabilities</strong>: Using the techniques discussed, find command injection vulnerabilities in a sample application.</li>
<li data-line="1" dir="auto"><strong>Exploit Vulnerabilities</strong>: Test various payloads to exploit the vulnerabilities and understand their impact.</li>
<li data-line="2" dir="auto"><strong>Mitigate Risks</strong>: Apply preventive measures to secure the application and ensure it is not vulnerable to command injection.</li>
</ol></div><div><p dir="auto">By the end of the session, you should have a solid understanding of command injection vulnerabilities, how to exploit them, and how to prevent them.</p></div><div class="mod-footer"></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button is-collapsed" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="achive\tryhackme\jr-penetration-tester\웹-해킹-소개\eng\8.-command-injection.html#8. Command Injection"><div class="tree-item-contents heading-link" heading-name="
Command Injection
"><span class="tree-item-title">Command Injection</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible is-collapsed" data-depth="2"><a class="tree-link" href="achive\tryhackme\jr-penetration-tester\웹-해킹-소개\eng\8.-command-injection.html#What_is_Command_Injection?"><div class="tree-item-contents heading-link" heading-name="What is Command Injection?"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">What is Command Injection?</span></div></a><div class="tree-item-children nav-folder-children" style="display: none;"><div class="tree-item" data-depth="4"><a class="tree-link" href="achive\tryhackme\jr-penetration-tester\웹-해킹-소개\eng\8.-command-injection.html#Understanding_Command_Injection"><div class="tree-item-contents heading-link" heading-name="Understanding Command Injection"><span class="tree-item-title">Understanding Command Injection</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="5"><a class="tree-link" href="achive\tryhackme\jr-penetration-tester\웹-해킹-소개\eng\8.-command-injection.html#나의_말:"><div class="tree-item-contents heading-link" heading-name="나의 말:"><span class="tree-item-title">나의 말:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="5"><a class="tree-link" href="achive\tryhackme\jr-penetration-tester\웹-해킹-소개\eng\8.-command-injection.html#ChatGPT의_말:"><div class="tree-item-contents heading-link" heading-name="ChatGPT의 말:"><span class="tree-item-title">ChatGPT의 말:</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible is-collapsed" data-depth="2"><a class="tree-link" href="achive\tryhackme\jr-penetration-tester\웹-해킹-소개\eng\8.-command-injection.html#What_is_Command_Injection?"><div class="tree-item-contents heading-link" heading-name="What is Command Injection?"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">What is Command Injection?</span></div></a><div class="tree-item-children nav-folder-children" style="display: none;"><div class="tree-item" data-depth="4"><a class="tree-link" href="achive\tryhackme\jr-penetration-tester\웹-해킹-소개\eng\8.-command-injection.html#Understanding_Command_Injection"><div class="tree-item-contents heading-link" heading-name="Understanding Command Injection"><span class="tree-item-title">Understanding Command Injection</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="achive\tryhackme\jr-penetration-tester\웹-해킹-소개\eng\8.-command-injection.html#Exploiting_Command_Injection"><div class="tree-item-contents heading-link" heading-name="Exploiting Command Injection"><span class="tree-item-title">Exploiting Command Injection</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="achive\tryhackme\jr-penetration-tester\웹-해킹-소개\eng\8.-command-injection.html#Mitigating_Command_Injection"><div class="tree-item-contents heading-link" heading-name="Mitigating Command Injection"><span class="tree-item-title">Mitigating Command Injection</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="achive\tryhackme\jr-penetration-tester\웹-해킹-소개\eng\8.-command-injection.html#Practical_Exercise"><div class="tree-item-contents heading-link" heading-name="Practical Exercise"><span class="tree-item-title">Practical Exercise</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>