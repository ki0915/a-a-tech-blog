<!DOCTYPE html> <html><head>
		<title>4. Nmap Basic Port Scan</title>
		<base href="..\..\..\..\../">
		<meta id="root-path" root-path="..\..\..\..\../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="Obsidian Vault - 4. Nmap Basic Port Scan">
		<meta property="og:title" content="4. Nmap Basic Port Scan">
		<meta property="og:description" content="Obsidian Vault - 4. Nmap Basic Port Scan">
		<meta property="og:type" content="website">
		<meta property="og:url" content="achive/tryhackme/jr-penetration-tester/네트워크-보안/eng/4.-nmap-basic-port-scan.html">
		<meta property="og:image" content="https://blog.kakaocdn.net/dn/pr0g8/btsk8nOm0c0/6kdqJgGWZkmIp05fOaSGyK/img.png">
		<meta property="og:site_name" content="Obsidian Vault">
		<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="lib/scripts/pixi.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="lib/scripts/minisearch.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><include src="lib/html/custom-head-content.html"></include><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="preload" href="lib/styles/other-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/other-plugins.css"></noscript><link rel="stylesheet" href="lib/styles/theme.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript><link rel="preload" href="lib/styles/snippets.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/snippets.css"></noscript></head><body class="publish css-settings-manager theme-dark show-inline-title show-ribbon ctp-latte ctp-mocha ctp-accent-rosewater anuppuccin-accent-toggle anp-h1-red anp-h2-peach anp-h3-green anp-h4-teal anp-h5-lavender anp-h6-mauve anp-bold-red anp-italic-green anp-highlight-yellow"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="4. Nmap Basic Port Scan"><ol start="4">
<li dir="auto">Nmap Basic Port Scan</li>
</ol></h1><div><div data-callout-metadata="" data-callout-fold="" data-callout="abstract" class="callout"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-clipboard-list"><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><path d="M12 11h4"></path><path d="M12 16h4"></path><path d="M8 11h.01"></path><path d="M8 16h.01"></path></svg></div><div class="callout-title-inner heading-wrapper"><h2 data-heading="Nmap Basic Port Scan" dir="auto" class="heading" id="Nmap_Basic_Port_Scan"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Nmap Basic Port Scan</h2><div class="heading-children"></div></div></div></div></div><div class="heading-wrapper"><h4 data-heading="Overview" dir="auto" class="heading" id="Overview"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Overview</h4><div class="heading-children"><div><hr></div><div><ul>
<li data-line="0" dir="auto">Finding accessible ports and services is important in network security. In this lesson, we will cover the process of finding out information about them.</li>
</ul></div></div></div><div class="heading-wrapper"><h4 data-heading="TCP and UDP ports" dir="auto" class="heading" id="TCP_and_UDP_ports"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>TCP and UDP ports</h4><div class="heading-children"><div><hr></div><div><ul>
<li data-line="0" dir="auto">Ports are often associated with services using specific port numbers. These ports are called well-known ports. For example, http is 80, ssh is 22, etc.</li>
<li data-line="1" dir="auto">There are two states for a port.</li>
</ul></div><div><p dir="auto">Open: If there is a service listening on that port.</p></div><div><p dir="auto">Closed: If there is no service listening on that port.</p></div><div><p dir="auto">However, in real situations, packets may be blocked by a firewall even if the port is open. Therefore, Nmap considers the following six states.</p></div><div><ol>
<li data-line="0" dir="auto"><strong>Open</strong>&nbsp;: Indicates that a service is listening on the specified port.</li>
<li data-line="1" dir="auto"><strong>Closed</strong>&nbsp;: Indicates that the port is accessible, but no service is listening on the specified port. Accessible means reachable and not blocked by a firewall or other security appliance/program.</li>
<li data-line="2" dir="auto"><strong>Filtered</strong>&nbsp;: Indicates that Nmap cannot determine whether the port is open or closed because the port is inaccessible. This condition is typically caused by a firewall that prevents Nmap from reaching that port. Nmap packets may be blocked from reaching the port, or responses may be blocked from reaching the Nmap host.</li>
<li data-line="3" dir="auto"><strong>Unfiltered</strong>: Nmap can access the port, but cannot determine whether the port is open or closed. This state occurs when using the ACK scan -sA.</li>
<li data-line="4" dir="auto"><strong>Open|Filtered</strong>: This means Nmap cannot determine whether the port is open or filtered.</li>
<li data-line="5" dir="auto"><strong>Closed|Filtered</strong>: This means Nmap cannot determine whether the port is closed or filtered.</li>
</ol></div><div><blockquote dir="auto">
<p>Question:</p>
</blockquote></div><div><div data-callout-metadata="" data-callout-fold="" data-callout="question" class="callout"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-help-circle"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><path d="M12 17h.01"></path></svg></div><div class="callout-title-inner">What service uses UDP port 53 by default?</div></div></div></div><div><p dir="auto">Answer: DNS</p></div><div><div data-callout-metadata="" data-callout-fold="" data-callout="question" class="callout"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-help-circle"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><path d="M12 17h.01"></path></svg></div><div class="callout-title-inner">What service uses TCP port 22 by default?</div></div></div></div><div><p dir="auto">Answer: SSH</p></div><div><div data-callout-metadata="" data-callout-fold="" data-callout="question" class="callout"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-help-circle"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><path d="M12 17h.01"></path></svg></div><div class="callout-title-inner">How many port states does Nmap consider?</div></div></div></div><div><p dir="auto">Answer: 6</p></div><div><div data-callout-metadata="" data-callout-fold="" data-callout="question" class="callout"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-help-circle"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><path d="M12 17h.01"></path></svg></div><div class="callout-title-inner">What are the most interesting port states to detect as a penetration tester?</div></div></div></div><div><p dir="auto">Answer: Open</p></div></div></div><div class="heading-wrapper"><h4 data-heading="TCP Flags" dir="auto" class="heading" id="TCP_Flags"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>TCP Flags</h4><div class="heading-children"><div><hr></div><div><p dir="auto">TCP connection scans work by completing the TCP 3-way handshake. In a standard TCP connection setup, the client sends a TCP packet with the SYN flag set, and the server responds with a SYN/ACK if the port is open. Finally, the client completes the 3-way handshake by sending an ACK.</p></div><div><p dir="auto"><img src="https://blog.kakaocdn.net/dn/pr0g8/btsk8nOm0c0/6kdqJgGWZkmIp05fOaSGyK/img.png" referrerpolicy="no-referrer"></p></div><div><p dir="auto">We are not interested in establishing a TCP connection, but rather in checking whether a TCP port is open. Therefore, we will send an RST/ACK to terminate the connection as soon as the state is confirmed. You can choose to perform a TCP connection scan using -sT.</p></div><div><p dir="auto"><img src="https://blog.kakaocdn.net/dn/mkXiV/btsk83u1Jg9/N0VtgWJcRo3CMm4eDrUWk1/img.png" referrerpolicy="no-referrer"></p></div><div><p dir="auto">Note that if you are not a privileged user (root or sudoer), scanning TCP connections is the only option that will detect open TCP ports.</p></div><div><p dir="auto">In the following Wireshark packet capture window, you can see that Nmap is sending TCP packets with the SYN flag set to various ports (256, 443, 143, etc.). By default, Nmap will attempt to connect to the 1000 most common ports. A closed TCP port responds to a SYN packet with an RST/ACK, indicating that it is not open. This pattern is repeated for all closed ports when attempting to initiate a TCP 3-way handshake.</p></div><div><p dir="auto"><img src="https://blog.kakaocdn.net/dn/Xf5Jk/btsk7IrPY8d/6dk6iLhZB4liJd86K5TzGk/img.png" referrerpolicy="no-referrer"></p></div><div><p dir="auto">We can see that port 143 is open, so it responds with a SYN/ACK, and Nmap sends an ACK, completing the 3-way handshake. The figure below shows all the packets exchanged between the Nmap host and port 143 on the target system. The first three packets are the TCP 3-way handshake that completes. The fourth packet is then broken down into RST/ACK packets.</p></div><div><p dir="auto"><img src="https://blog.kakaocdn.net/dn/Wb00q/btsk7p0i8lU/dP9mxlmUC2YTf560qiTlYk/img.png" referrerpolicy="no-referrer"></p></div><div><p dir="auto">To illustrate (TCP connection scan), -sT The following command example returns a detailed list of open ports.</p></div><div><p dir="auto">Penetration Tester Terminal pentester@TryHackMe<strong>$</strong> nmap -sT MACHINE_IP Starting Nmap 7.60 ( <a data-tooltip-position="top" aria-label="https://nmap.org/" rel="noopener" class="external-link" href="https://nmap.org/" target="_blank">https://nmap.org</a> ) at 2021-08-30 09:53 BST Nmap scan report for MACHINE_IP Host is up (0.0024s latency).</p></div><div><p dir="auto">Not shown: 995 closed ports</p></div><div><p dir="auto">PORT&nbsp;&nbsp;&nbsp;&nbsp;STATE SERVICE</p></div><div><p dir="auto">22/tcp&nbsp;&nbsp;open&nbsp;&nbsp;ssh</p></div><div><p dir="auto">25/tcp&nbsp;&nbsp;open&nbsp;&nbsp;smtp</p></div><div><p dir="auto">80/tcp&nbsp;&nbsp;open&nbsp;&nbsp;http</p></div><div><p dir="auto">111/tcp open&nbsp;&nbsp;rpcbind</p></div><div><p dir="auto">143/tcp open&nbsp;&nbsp;imap</p></div><div><p dir="auto">MAC Address: 02:45:BF:8A:2D:6B (Unknown )</p></div><div><p dir="auto">Nmap done: 1 IP address (1 host up) scanned in 0.40 seconds</p></div><div><p dir="auto">-F Enables fast mode and can be used to reduce the number of ports scanned from 1000 to the 100 most common ports.</p></div><div><p dir="auto">It is worth mentioning that you can also add the -r option to scan ports in sequential order rather than random order. This option is useful for testing whether ports are opened in a consistent way when the target boots, for example. Useful.</p></div><div><blockquote dir="auto">
<p>Problem:</p>
</blockquote></div><div><div data-callout-metadata="" data-callout-fold="" data-callout="question" class="callout"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-help-circle"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><path d="M12 17h.01"></path></svg></div><div class="callout-title-inner">Start the VM. Open AttackBox and run nmap -sT MACHINE_IP via terminal. A new service was installed on this VM since the last scan. Which port numbers were closed in the scan above? Is it now open on this target VM?</div></div></div></div><div><p dir="auto">Answer: 110</p></div><div><div data-callout-metadata="" data-callout-fold="" data-callout="question" class="callout"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-help-circle"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><path d="M12 17h.01"></path></svg></div><div class="callout-title-inner">What is Nmap's guess about the newly installed service?</div></div></div></div><div><p dir="auto">Answer: POP3</p></div><div><p dir="auto">Unprivileged users are limited to connection scans. However, the default scan mode is SYN scan, which requires a privileged (root or sudoer) user to run. SYN scans require the TCP 3-way handshake to complete. There is no connection. Instead, it disconnects when it gets a response from the server. This reduces the possibility of the scan being logged since it does not establish a TCP connection. You can select this scan type using the option -sS. The figure below shows a TCP 3-way Shows how a TCP SYN scan works without completing the handshake. <img src="https://blog.kakaocdn.net/dn/cmVAPV/btsk7pTzbpf/Qq0pWZUYJoig2ib9vUekQK/img.png" referrerpolicy="no-referrer"></p></div><div><p dir="auto">The following screenshot from Wireshark shows a TCP SYN scan. For closed TCP ports, the behavior is similar to that of a TCP connection scan. Similar to the action.</p></div><div><p dir="auto"><img src="https://blog.kakaocdn.net/dn/L30pP/btsk4OTECmR/xR5fTLdY8dD9KbiKCIUYS0/img.png" referrerpolicy="no-referrer"></p></div><div><p dir="auto">To better see the difference between the two scans, consider the following screenshots. In the top half of the following figure, we see a TCP connection scan - sT traffic. Every open TCP port requires Nmap to complete the TCP 3-way handshake before closing the connection. In the bottom half of the following figure, we see a SYN scan. You can see that there is no need to complete this -sSTCP 3-way handshake. Instead, Nmap sends an RST packet when a SYN/ACK packet is received. <img src="https://blog.kakaocdn.net/dn/8R6vp/btsk5QRourw/RgvhczOtmeJtZmkc6IHSO1/img.png" referrerpolicy="no-referrer"></p></div><div><p dir="auto">TCP SYN scan is the default scan when running Nmap as a privileged user, as root, or using sudo. This is a very stable choice. It successfully found open ports previously found by TCP connection scan, but the TCP connection with the target was not fully established. Penetration Tester Terminal pentester@TryHackMe<strong>$</strong> sudo nmap -sS MACHINE_IP Starting Nmap 7.60 ( <a data-tooltip-position="top" aria-label="https://nmap.org/" rel="noopener" class="external-link" href="https://nmap.org/" target="_blank">https://nmap.org</a> ) at 2021-08-30 09:53 BST Nmap scan report for MACHINE_IP Host is up (0.0073s latency).</p></div><div><p dir="auto">Not shown: 994 closed ports</p></div><div><p dir="auto">PORT&nbsp;&nbsp;&nbsp;&nbsp;STATE SERVICE</p></div><div><p dir="auto">22/tcp&nbsp;&nbsp;open&nbsp;&nbsp;ssh</p></div><div><p dir="auto">25/tcp&nbsp;&nbsp;open&nbsp;&nbsp;smtp</p></div><div><p dir="auto">80/tcp&nbsp;&nbsp;open&nbsp;&nbsp;http</p></div><div><p dir="auto">110/tcp open&nbsp;&nbsp;pop3</p></div><div><p dir="auto">111/tcp open&nbsp;&nbsp;rpcbind</p></div><div><p dir="auto">143/tcp open&nbsp;&nbsp;imap</p></div><div><p dir="auto">MAC Address: 02:45:BF:8A: 2D:6B (Unknown)</p></div><div><p dir="auto">Nmap done: 1 IP address (1 host up) scanned in 1.60 seconds</p></div><div><blockquote dir="auto">
<p>Problem:</p>
</blockquote></div><div><p dir="auto">Start the VM. Some new server software has been installed since the last scan. Using the terminal on the AttackBox, nmap - sS MACHINE_IP. What are the new open ports?</p></div><div><p dir="auto">Answer: 6667</p></div><div><div data-callout-metadata="" data-callout-fold="" data-callout="question" class="callout"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-help-circle"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><path d="M12 17h.01"></path></svg></div><div class="callout-title-inner">What is Nmap's guess about the service name?</div></div></div></div><div><p dir="auto">Answer: IRC</p></div></div></div><div class="heading-wrapper"><h4 data-heading="UDP Scan" dir="auto" class="heading" id="UDP_Scan"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>UDP Scan</h4><div class="heading-children"><div><hr></div><div><p dir="auto">UDP is a connectionless protocol, so it does not require a handshake to establish a connection. UDP There is no guarantee that a service listening on a port will respond to the packet. However, if a UDP packet is sent to a closed port, an ICMP port unreachable error (type 3, code 3) is returned. You can select UDP scanning using the option can be combined with -sU. Also can be combined with other TCP scans.</p></div><div><p dir="auto">The following figure shows that if you send a UDP packet to an open UDP port, you cannot expect a response. Therefore, even if you send a UDP packet to an open port, you will not know anything.</p></div><div><p dir="auto">![](<a rel="noopener" class="external-link" href="https://blog.kakaocdn.net/dn" target="_blank">https://blog.kakaocdn.net/dn</a> /c6Wulk/btsk8LIbWjw/GFcOhcZTNMkkMsuVU8WH2K/img.png)</p></div><div><p dir="auto">However, as you can see in the image below, I expect an ICMP packet of type 3, destination unreachable and code 3, port unreachable. That is, no response is generated. A UDP port that is not open is one that Nmap marks as open. <img src="https://blog.kakaocdn.net/dn/ourK6/btsk8232uvJ/5lrnhqwLRcMCTHiqY8DFi0/img.png" referrerpolicy="no-referrer"></p></div><div><p dir="auto">In the Wireshark capture below, all closed ports are unreachable ICMP packet destinations (port unreachable). You can see that it is generating .</p></div><div><p dir="auto"><img src="https://blog.kakaocdn.net/dn/bDgkyx/btsk8KJiLRE/i4ENj4NbxEWkFUKgm6YvfK/img.png" referrerpolicy="no-referrer"></p></div><div><p dir="auto">Starting a UDP scan against this Linux server proved worth it, and indeed, port 111 was open. . On the other hand, Nmap cannot determine whether UDP port 68 is open or filtered. Penetration Tester Terminal pentester@TryHackMe<strong>$</strong> sudo nmap -sU MACHINE_IP Starting Nmap 7.60 ( <a data-tooltip-position="top" aria-label="https://nmap.org/" rel="noopener" class="external-link" href="https://nmap.org/" target="_blank">https://nmap.org</a> ) at 2021-08-30 09:54 BST Nmap scan report for MACHINE_IP Host is up (0.00061s latency).</p></div><div><p dir="auto">Not shown: 998 closed ports</p></div><div><p dir="auto">PORT&nbsp;&nbsp;&nbsp;&nbsp;STATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SERVICE</p></div><div><p dir="auto">68/udp&nbsp;&nbsp;open|filtered dhcpc</p></div><div><p dir="auto">111/udp open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rpcbind</p></div><div><p dir="auto">MAC Address: 02:45:BF:8A:2D:6B (Unknown)</p></div><div><p dir="auto">Nmap done: 1 IP address (1 host up) scanned in 1085.05 seconds</p></div><div><blockquote dir="auto">
<p>Problem:</p>
</blockquote></div><div><p dir="auto">Start the VM. Using the terminal in the AttackBox, run nmap -sU -F -v MACHINE_IP. A new service was installed since the last scan. What UDP ports are currently open?</p></div><div><blockquote dir="auto">
<p>Problem:</p>
</blockquote></div><div><p dir="auto">Start the VM. Using the terminal in the AttackBox, run nmap -sU -F -v MACHINE_IP. A new service was installed since the last scan. What UDP ports are currently open?<br>
Answer: 53</p></div><div><div data-callout-metadata="" data-callout-fold="" data-callout="question" class="callout"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-help-circle"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><path d="M12 17h.01"></path></svg></div><div class="callout-title-inner">What is the service name according to Nmap?</div></div></div></div><div><p dir="auto">Answer: domain</p></div></div></div><div class="heading-wrapper"><h4 data-heading="Fine-tuning scope and performance" dir="auto" class="heading" id="Fine-tuning_scope_and_performance"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Fine-tuning scope and performance</h4><div class="heading-children"><div><hr></div><div><p dir="auto">You can specify ports to scan instead of the default 1000 ports. Port specification is now intuitive. Let's look at some examples.</p></div><div><ul>
<li data-line="0" dir="auto">Port list: -p22,80,443 Scan ports 22, 80, and 443. - Port ranges: -p1 - scan all ports between 10231 and 1023, -p20-25 - scan ports between 20 and 25.</li>
</ul></div><div><p dir="auto">You can request a scan of all ports using -p-, which scans all 65535 ports. To scan the 100 most common ports, use -F. --top-ports 10 will check the 10 most common ports.</p></div><div><p dir="auto">You can control the timing of the scan using -T&lt;0-5&gt;. -T0 is the slowest (paranoid) and -T5 is the fastest. According to the Nmap man page, there are 6 templates.</p></div><div><ul>
<li data-line="0" dir="auto">Paranoid (0)</li>
<li data-line="1" dir="auto">Mean (1)</li>
<li data-line="2" dir="auto">Polite (2)</li>
<li data-line="3" dir="auto">Normal (3)</li>
<li data-line="4" dir="auto">Aggressive (4)</li>
<li data-line="5" dir="auto">Crazy (5)</li>
</ul></div><div><p dir="auto">To avoid IDS warnings, you can consider -T0 or -T1. For example, -T0 scans one port at a time and waits 5 minutes between each probe transmission, which gives you an idea of ​​how long it takes for a single target scan to complete. If no timing is specified, Nmap uses normal -T3. -T5 is the most aggressive in terms of speed. However, this may affect the accuracy of the scan results due to the increased possibility of packet loss. Commonly used during CTF and -T4 training to learn how to scan a target, while -T1 is more commonly used during real-world engagements where stealth is more important.</p></div><div><p dir="auto">You can choose to control the packet rate using --min-rate number or --max-rate number . For example, --max-rate 10 or --max-rate=10 will ensure that the scanner does not send more than 10 packets per second.</p></div><div><p dir="auto">You can also control the probing parallelism using --min-parallelism numprobes and --max-parallelism numprobes &gt; . Nmap probes a target to discover which hosts are active and which ports are open. Probe parallelism specifies how many probes can run in parallel. For example, push --min-parallelism=512Nmap to keep at least 512 probes in parallel. These 512 probes are related to host discovery and open ports.</p></div><div><blockquote dir="auto">
<p>Question:</p>
</blockquote></div><div><p dir="auto">What is the option to scan all TCP ports between 5000 and 5500?</p></div><div><p dir="auto">Answer: -p5000-5500</p></div><div><p dir="auto">How can I ensure that Nmap runs at least 64 probes in parallel?</p></div><div><p dir="auto">Answer: --min-parallelism=64</p></div><div><p dir="auto">What option would you add to make Nmap very slow and paranoid?</p></div><div><p dir="auto">Answer: -T0</p></div><div><ol start="3">
<li data-line="0" dir="auto">Summary</li>
</ol></div><div dir="auto" style="overflow-x: auto;"><table>
<thead>
<tr>
<th dir="auto"></th>
<th dir="auto"></th>
</tr>
</thead>
<tbody>
<tr>
<td dir="ltr"><strong>4.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>Port</strong>&nbsp;<strong>Scan</strong>&nbsp;<strong>Type</strong></td>
<td dir="ltr"><strong>Example</strong>&nbsp;<strong>Command</strong></td>
</tr>
<tr>
<td dir="ltr">TCP Connection Scan</td>
<td dir="ltr">nmap -sT MACHINE_IP</td>
</tr>
<tr>
<td dir="ltr">TCP SYN Scan</td>
<td dir="ltr">sudo nmap -sS MACHINE_IP</td>
</tr>
<tr>
<td dir="ltr">UDP Scan</td>
<td dir="ltr">sudo nmap -sU MACHINE_IP</td>
</tr>
</tbody>
</table></div><div><p dir="auto">This type of scan should start a search for TCP and UDP services running on the target host.</p></div><div dir="auto" style="overflow-x: auto;"><table>
<thead>
<tr>
<th dir="auto"></th>
<th dir="auto"></th>
</tr>
</thead>
<tbody>
<tr>
<td dir="ltr"><strong>Options</strong></td>
<td dir="ltr"><strong>Purpose</strong></td>
</tr>
<tr>
<td dir="ltr">-p1-1023</td>
<td dir="ltr">Scan ports 1 to 1023</td>
</tr>
<tr>
<td dir="ltr">-F</td>
<td dir="ltr">100 most common ports</td>
</tr>
<tr>
<td dir="ltr">-r</td>
<td dir="ltr">Scan ports in sequential order</td>
</tr>
<tr>
<td dir="ltr">-T&lt;0-5&gt;</td>
<td dir="ltr">-T0 is slowest, T5 is fastest</td>
</tr>
<tr>
<td dir="ltr">--max-rate 50</td>
<td dir="ltr">Rate &lt;= 50 packets/s</td>
</tr>
<tr>
<td dir="ltr">--min-rate 15</td>
<td dir="ltr">Rate &gt;= 15 packets/s</td>
</tr>
<tr>
<td dir="ltr">--min-parallelism 100</td>
<td dir="ltr">At least 100 probes in parallel</td>
</tr>
</tbody>
</table></div><div class="mod-footer"></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button is-collapsed" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="achive\tryhackme\jr-penetration-tester\네트워크-보안\eng\4.-nmap-basic-port-scan.html#4. Nmap Basic Port Scan"><div class="tree-item-contents heading-link" heading-name="
Nmap Basic Port Scan
"><span class="tree-item-title">Nmap Basic Port Scan</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible is-collapsed" data-depth="2"><a class="tree-link" href="achive\tryhackme\jr-penetration-tester\네트워크-보안\eng\4.-nmap-basic-port-scan.html#Nmap_Basic_Port_Scan"><div class="tree-item-contents heading-link" heading-name="Nmap Basic Port Scan"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Nmap Basic Port Scan</span></div></a><div class="tree-item-children nav-folder-children" style="display: none;"><div class="tree-item" data-depth="4"><a class="tree-link" href="achive\tryhackme\jr-penetration-tester\네트워크-보안\eng\4.-nmap-basic-port-scan.html#Overview"><div class="tree-item-contents heading-link" heading-name="Overview"><span class="tree-item-title">Overview</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="achive\tryhackme\jr-penetration-tester\네트워크-보안\eng\4.-nmap-basic-port-scan.html#TCP_and_UDP_ports"><div class="tree-item-contents heading-link" heading-name="TCP and UDP ports"><span class="tree-item-title">TCP and UDP ports</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="achive\tryhackme\jr-penetration-tester\네트워크-보안\eng\4.-nmap-basic-port-scan.html#TCP_Flags"><div class="tree-item-contents heading-link" heading-name="TCP Flags"><span class="tree-item-title">TCP Flags</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="achive\tryhackme\jr-penetration-tester\네트워크-보안\eng\4.-nmap-basic-port-scan.html#UDP_Scan"><div class="tree-item-contents heading-link" heading-name="UDP Scan"><span class="tree-item-title">UDP Scan</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="achive\tryhackme\jr-penetration-tester\네트워크-보안\eng\4.-nmap-basic-port-scan.html#Fine-tuning_scope_and_performance"><div class="tree-item-contents heading-link" heading-name="Fine-tuning scope and performance"><span class="tree-item-title">Fine-tuning scope and performance</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>