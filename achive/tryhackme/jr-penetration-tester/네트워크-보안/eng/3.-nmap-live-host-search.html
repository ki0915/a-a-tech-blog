<!DOCTYPE html> <html><head>
		<title>3. Nmap Live Host Search</title>
		<base href="..\..\..\..\../">
		<meta id="root-path" root-path="..\..\..\..\../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="Obsidian Vault - 3. Nmap Live Host Search">
		<meta property="og:title" content="3. Nmap Live Host Search">
		<meta property="og:description" content="Obsidian Vault - 3. Nmap Live Host Search">
		<meta property="og:type" content="website">
		<meta property="og:url" content="achive/tryhackme/jr-penetration-tester/네트워크-보안/eng/3.-nmap-live-host-search.html">
		<meta property="og:image" content="https://blog.kakaocdn.net/dn/7ULT9/btskVL3oRd7/KEMpRJHeaGnVwvMNg1fVWK/img.png">
		<meta property="og:site_name" content="Obsidian Vault">
		<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="lib/scripts/pixi.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="lib/scripts/minisearch.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><include src="lib/html/custom-head-content.html"></include><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="preload" href="lib/styles/other-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/other-plugins.css"></noscript><link rel="stylesheet" href="lib/styles/theme.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript><link rel="preload" href="lib/styles/snippets.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/snippets.css"></noscript></head><body class="publish css-settings-manager theme-dark show-inline-title show-ribbon ctp-latte ctp-mocha ctp-accent-rosewater anuppuccin-accent-toggle anp-h1-red anp-h2-peach anp-h3-green anp-h4-teal anp-h5-lavender anp-h6-mauve anp-bold-red anp-italic-green anp-highlight-yellow"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="3. Nmap Live Host Search"><ol start="3">
<li dir="auto">Nmap Live Host Search</li>
</ol></h1><div><div data-callout-metadata="" data-callout-fold="" data-callout="abstract" class="callout"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-clipboard-list"><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><path d="M12 11h4"></path><path d="M12 16h4"></path><path d="M8 11h.01"></path><path d="M8 16h.01"></path></svg></div><div class="callout-title-inner heading-wrapper"><h2 data-heading="Nmap Live Host Search" dir="auto" class="heading" id="Nmap_Live_Host_Search"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Nmap Live Host Search</h2><div class="heading-children"></div></div></div></div></div><div class="heading-wrapper"><h4 data-heading="Overview" dir="auto" class="heading" id="Overview"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Overview</h4><div class="heading-children"><div><hr></div><div><p dir="auto">When gathering information about a network, we need an efficient tool to handle repetitive tasks and answer the following questions:</p></div><div><ol>
<li data-line="0" dir="auto">Which systems are up and running?</li>
<li data-line="1" dir="auto">What services are running on these systems?</li>
</ol></div><div><p dir="auto">For this purpose, the tool we will use is Nmap. We will actively explore systems and services using Nmap. Nmap was created by network security expert and open-source programmer Gordon Lyon (Fyodor) and was released in 1997. Nmap, short for Network Mapper, is free open-source software released under the GPL license. Nmap is an industry-standard tool for network mapping, live host identification, and service discovery. The Nmap scripting engine can further extend its capabilities, from fingerprinting services to exploiting vulnerabilities. Nmap scans typically follow the steps shown in the diagram below, though most are optional and depend on the command-line arguments provided.</p></div></div></div><div class="heading-wrapper"><h4 data-heading="1. Subnet" dir="auto" class="heading" id="1._Subnet"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>1. Subnet</h4><div class="heading-children"><div><hr></div><div><p dir="auto">Let's review a few terms. A network <em>segment</em> is a group of computers connected using a shared medium. For example, the medium could be an Ethernet switch or a WiFi access point. In an IP network, a <em>subnet</em> usually refers to one or more network segments connected together and configured to use the same router. A network segment represents a physical connection, while a subnet represents a logical connection.</p></div><div><p dir="auto">The following network diagram shows four network segments or subnets. Typically, systems are connected to one of these network segments/subnets. A subnet, or simply subnet, has its own IP address range and is connected to a broader network via a router. Each network may have a firewall to enforce security policies.</p></div><div><p dir="auto"><img src="https://blog.kakaocdn.net/dn/7ULT9/btskVL3oRd7/KEMpRJHeaGnVwvMNg1fVWK/img.png" referrerpolicy="no-referrer"></p></div><div><p dir="auto">The above diagram shows two types of subnets.</p></div><div><ul>
<li data-line="0" dir="auto">A contained subnet can use a subnet mask of /16, meaning 255.255.0.0. This subnet can accommodate about 65,000 hosts.</li>
<li data-line="1" dir="auto">A subnet mask of /24 means 255.255.255.0, indicating that this subnet can have about 250 hosts.</li>
</ul></div><div><p dir="auto">For more details about subnets, refer to Task 2 of the <a data-tooltip-position="top" aria-label="https://tryhackme.com/room/introtolan" rel="noopener" class="external-link" href="https://tryhackme.com/room/introtolan" target="_blank">Introduction to LAN</a> room.</p></div><div><p dir="auto">As part of active reconnaissance, we aim to gather more information about a group of hosts or a subnet. If you are connected to the same subnet, you can expect the scanner to rely on ARP (Address Resolution Protocol) queries to search for live hosts. ARP queries aim to retrieve hardware addresses (MAC addresses) to enable communication through the link layer. However, you can infer that a host is online by using this method. (We revisit link-layer in Task 4.)</p></div><div><p dir="auto">If you are on Network A, you can only scan devices within that subnet (10.1.100.0/24) using ARP. Suppose you are connected to a different subnet than the target system’s subnet. In that case, any packets generated by the scanner will be routed through the default gateway (router) to reach systems in another subnet. However, ARP queries are not routable and thus cannot pass through a subnet router. ARP is a link-layer protocol, and ARP packets are bound to their respective subnets.</p></div><div><p dir="auto">To start the network simulator, click the "View Site" button. You will use this simulator to answer the questions in Tasks 2, 4, and 5.</p></div><div><blockquote dir="auto">
<p>Practice</p>
</blockquote></div><div><p dir="auto">Packets are sent with the following details:</p></div><div><ul>
<li data-line="0" dir="auto">From computer1</li>
<li data-line="1" dir="auto">To computer1 (to indicate broadcast)</li>
<li data-line="2" dir="auto">Packet type: "ARP request"</li>
<li data-line="3" dir="auto">Data: computer6 (requesting the MAC address of computer6 using an ARP request)</li>
</ul></div><div><div data-callout-metadata="" data-callout-fold="" data-callout="question" class="callout"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-help-circle"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><path d="M12 17h.01"></path></svg></div><div class="callout-title-inner">How many devices can see the ARP request?</div></div></div></div><div><p dir="auto">Answer: 4</p></div><div><div data-callout-metadata="" data-callout-fold="" data-callout="question" class="callout"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-help-circle"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><path d="M12 17h.01"></path></svg></div><div class="callout-title-inner">Did computer6 receive the ARP request? (Yes/No)</div></div></div></div><div><p dir="auto">Answer: No</p></div><div><p dir="auto">Packets are sent with the following details:</p></div><div><ul>
<li data-line="0" dir="auto">From computer4</li>
<li data-line="1" dir="auto">To computer4 (to indicate broadcast)</li>
<li data-line="2" dir="auto">Packet type: "ARP request"</li>
<li data-line="3" dir="auto">Data: computer6 (requesting the MAC address of computer6 using an ARP request)</li>
</ul></div><div><p dir="auto">How many devices can see the ARP request?</p></div><div><p dir="auto">Answer: 4</p></div><div><p dir="auto">Did computer6 respond to the ARP request? (Yes/No)</p></div><div><p dir="auto">Answer: Yes</p></div></div></div><div class="heading-wrapper"><h4 data-heading="2. Target Enumeration" dir="auto" class="heading" id="2._Target_Enumeration"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>2. Target Enumeration</h4><div class="heading-children"><div><hr></div><div><p dir="auto">You can specify targets to scan against your attack target. Typically, you can provide a list, a range, or a subnet. Examples are as follows:</p></div><div><ul>
<li data-line="0" dir="auto">List: Scans three IP addresses: MACHINE_IP scanme.nmap.org example.com.</li>
<li data-line="1" dir="auto">Range: Scans 6 IP addresses: 10.11.12.15-20, meaning 10.11.12.15, 10.11.12.16, …, and 10.11.12.20.</li>
<li data-line="2" dir="auto">Subnet: Scans 4 IP addresses: MACHINE_IP/30.</li>
</ul></div><div><p dir="auto">You can also provide a file as input for the target list with <code>nmap -iL list_of_hosts.txt</code>.</p></div><div><p dir="auto">To verify the list of hosts that Nmap will scan, use <code>nmap -sL TARGETS</code>. This option provides a detailed list of hosts that Nmap will scan without actually scanning them. However, Nmap will attempt a reverse DNS lookup on all targets to obtain names. Names can reveal various information to the penetration tester. (If you don't want Nmap to query the DNS server, you can add <code>-n</code>.)</p></div><div><p dir="auto">Practice:</p></div><div><p dir="auto">What is the first IP address that Nmap will scan if given the target IP address?</p></div><div><p dir="auto">Answer: 10.10.12.8</p></div><div><p dir="auto">If the following range is provided, how many IP addresses will Nmap scan? (Target IP address and range)</p></div><div><p dir="auto"><code>nmap -sL -n</code> (with the target IP address and range)</p></div><div><p dir="auto">Answer: 6400</p></div></div></div><div class="heading-wrapper"><h4 data-heading="3. Live Host Discovery" dir="auto" class="heading" id="3._Live_Host_Discovery"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>3. Live Host Discovery</h4><div class="heading-children"><div><hr></div><div><p dir="auto">Let's take another look at the TCP/IP layers shown in the diagram below. We can use protocols to discover live hosts. Starting from the bottom up, we can use:</p></div><div><ul>
<li data-line="0" dir="auto">ARP at the Link Layer</li>
<li data-line="1" dir="auto">ICMP at the Network Layer</li>
<li data-line="2" dir="auto">TCP at the Transport Layer</li>
<li data-line="3" dir="auto">UDP at the Transport Layer</li>
</ul></div><div><p dir="auto"><img src="https://blog.kakaocdn.net/dn/PSG1e/btskSm4s2bC/5TfZk0vVTXhdvwT7pgmUK0/img.png" referrerpolicy="no-referrer"></p></div><div><p dir="auto">Before discussing how scanners can use each of these, let's briefly review these four protocols. The purpose of ARP is singular: to send a frame to the broadcast address of the network segment and request a specific computer with a particular IP address to provide its MAC (hardware) address in response.</p></div><div><p dir="auto"><a data-tooltip-position="top" aria-label="https://www.iana.org/assignments/icmp-parameters/icmp-parameters.xhtml" rel="noopener" class="external-link" href="https://www.iana.org/assignments/icmp-parameters/icmp-parameters.xhtml" target="_blank">ICMP</a> has many types. ICMP ping uses type 8 (echo) and type 0 (echo reply).</p></div><div><p dir="auto">To ping systems on the same subnet, an ARP query must be performed before the ICMP Echo.</p></div><div><p dir="auto">While TCP and UDP are transport layer protocols, for network scanning, the scanner can send specially crafted packets to a standard TCP or UDP port to check whether the target responds. This method is particularly effective if ICMP Echo is blocked.</p></div><div><p dir="auto">If you closed the network simulator, click the "View Site" button in Task 2 to reopen it.</p></div><div><p dir="auto"><img src="https://blog.kakaocdn.net/dn/bhHKCT/btskT2EhzBH/us5U3wJKQ8mDwC10zzNN9k/img.png" referrerpolicy="no-referrer"></p></div></div></div><div class="heading-wrapper"><h4 data-heading="4. Host Discovery with Nmap Using ARP" dir="auto" class="heading" id="4._Host_Discovery_with_Nmap_Using_ARP"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>4. Host Discovery with Nmap Using ARP</h4><div class="heading-children"><div><hr></div><div><p dir="auto">Overview:</p></div><div><p dir="auto">How do you know which hosts are running? It’s crucial not to waste time port scanning offline hosts or unused IP addresses. There are several methods to search for online hosts. If no host discovery option is provided, Nmap follows these approaches to find live hosts:</p></div><div><ol>
<li data-line="0" dir="auto">If a <em>privileged</em> user attempts to scan a target on the local network (Ethernet), Nmap uses an <em>ARP request</em>. A privileged user is <code>root</code>, a <code>.sudoers</code>, or someone using <code>sudo</code>.</li>
<li data-line="1" dir="auto">If a <em>privileged</em> user attempts to scan a target outside the local network, Nmap uses ICMP Echo requests, TCP ACK on port 80, TCP SYN on port 443, and ICMP Timestamp requests.</li>
<li data-line="2" dir="auto">If an <em>unprivileged</em> user attempts to scan a target outside the local network, Nmap relies on sending SYN packets to ports 80 and 443 for a TCP three-way handshake.</li>
</ol></div><div><p dir="auto">Nmap, by default, uses ping scan to find live hosts and then only scans those live hosts. To search for online hosts without performing a port scan using Nmap, use <code>nmap -sn TARGETS</code>. Let’s dive deeper to gain a clear understanding of the various techniques used.</p></div><div><p dir="auto">Practice:</p></div><div><p dir="auto">ARP scanning is only possible if you are on the same subnet as the target system. In Ethernet (802.3) and WiFi (802.11), you need to know the MAC address of the system before communicating with it. The MAC address is required in the link-layer header, which includes fields like the source MAC address and destination MAC address. To obtain the MAC address, the OS sends an ARP query. Hosts that respond to the ARP query are operational. ARP queries only work if the target is on the same subnet as the user, meaning on the same Ethernet/WiFi. During an Nmap scan of the local network, you should expect to see many ARP queries generated. To perform an ARP scan without a port scan using Nmap, use <code>nmap -PR -sn TARGETS</code>, where <code>-PR</code> indicates that only ARP probing is desired. The following example shows Nmap using ARP to search for hosts without a port scan: <code>nmap -PR -sn MACHINE_IP/24</code> is executed to discover all live systems on the same subnet as the target machine.</p></div><div><p dir="auto">Penetration Tester Terminal</p></div><div class="tab-container"><ul class="tabs"><li class="tab-item active">(x)</li><li class="tab-item">(x)</li><li class="tab-item">(x)</li><li class="tab-item">(x)</li><li class="tab-item">(x)</li><li class="tab-item">(x)</li><li class="tab-item">(x)</li><li class="tab-item">(x)</li><li class="tab-item">(x)</li><li class="tab-item">(x)</li><li class="tab-item">(x)</li><li class="tab-item">(x)</li><li class="tab-item">(x)</li><li class="tab-item">(x)</li></ul><div class="tab-contents"><div class="tab-content active"><pre><code>pentester@TryHackMe$ sudo nmap -PR -sn 10.10.210.6/24
</code><button class="copy-code-button">복사</button></pre></div><div class="tab-content"><pre><code>Starting Nmap 7.60 ( https://nmap.org ) at 2021-09-02 07:12 BST
</code><button class="copy-code-button">복사</button></pre></div><div class="tab-content"><pre><code>Nmap scan report for ip-10-10-210-75.eu-west-1.compute.internal (10.10.210.75)
</code><button class="copy-code-button">복사</button></pre></div><div class="tab-content"><pre><code>Host is up (0.00013s latency).
</code><button class="copy-code-button">복사</button></pre></div><div class="tab-content"><pre><code>MAC Address: 02:83:75:3A:F2:89 (Unknown)
</code><button class="copy-code-button">복사</button></pre></div><div class="tab-content"><pre><code>Nmap scan report for ip-10-10-210-100.eu-west-1.compute.internal (10.10.210.100)
</code><button class="copy-code-button">복사</button></pre></div><div class="tab-content"><pre><code>Host is up (-0.100s latency).
</code><button class="copy-code-button">복사</button></pre></div><div class="tab-content"><pre><code>MAC Address: 02:63:D0:1B:2D:CD (Unknown)
</code><button class="copy-code-button">복사</button></pre></div><div class="tab-content"><pre><code>Nmap scan report for ip-10-10-210-165.eu-west-1.compute.internal (10.10.210.165)
</code><button class="copy-code-button">복사</button></pre></div><div class="tab-content"><pre><code>Host is up (0.00025s latency).
</code><button class="copy-code-button">복사</button></pre></div><div class="tab-content"><pre><code>MAC Address: 02:59:79:4F:17:B7 (Unknown)
</code><button class="copy-code-button">복사</button></pre></div><div class="tab-content"><pre><code>Nmap scan report for ip-10-10-210-6.eu-west-1.compute.internal (10.10.210.6)
</code><button class="copy-code-button">복사</button></pre></div><div class="tab-content"><pre><code>Host is up.
</code><button class="copy-code-button">복사</button></pre></div><div class="tab-content"><pre><code>Nmap done: 256 IP addresses (4 hosts up) scanned in 3.12 seconds
</code><button class="copy-code-button">복사</button></pre></div></div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div><p dir="auto">This command generates many ARP queries that can be observed using tools such as <code>arp-scan</code>, <code>tcpdump</code>, <code>Wireshark</code>, or similar tools. We can observe the traffic pattern and packet capture for such traffic with <code>arp-scan</code> and <code>nmap -PR -sn</code>. Below is the Wireshark output.</p></div><div><p dir="auto"><img src="https://blog.kakaocdn.net/dn/bvd1xv/btskT1L9UlP/DPbeehqKZSoGlCjyxba7ik/img.png" referrerpolicy="no-referrer"></p></div><div><p dir="auto">If you have closed the network simulator, click the "View Site" button in Task 2 to display it again.</p></div><div><p dir="auto"><strong>Problem:</strong></p></div><div><p dir="auto">Send a broadcast ARP request packet using the following options:</p></div><div><ul>
<li data-line="0" dir="auto">From Computer1</li>
<li data-line="1" dir="auto">To computer1 (indicating broadcast)</li>
<li data-line="2" dir="auto">Packet type: "ARP Request"</li>
<li data-line="3" dir="auto">Data: Try to reach all 8 devices on the network (excluding computer1) (computer2, computer3, computer4, computer5, computer6, switch1, switch2, and router).</li>
</ul></div></div></div><div class="heading-wrapper"><h4 data-heading="5. Host Discovery Using ICMP with Nmap" dir="auto" class="heading" id="5._Host_Discovery_Using_ICMP_with_Nmap"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>5. Host Discovery Using ICMP with Nmap</h4><div class="heading-children"><div><p dir="auto"><strong>Overview:</strong></p></div><div><p dir="auto">You can ping all IP addresses in the target network and see who responds to our ping request (ICMP Type 8/Echo) with a ping response (ICMP Type 0). Sounds simple, right? While this is the simplest method, it is not always reliable. Many firewalls block ICMP echo requests. Recent versions of MS Windows are configured with host firewalls that block ICMP echo requests by default. Remember that ARP queries take precedence over ICMP requests when the target is on the same subnet.</p></div><div><p dir="auto">To search for live hosts using ICMP echo requests, add the <code>-PE</code> option to <code>nmap -sn</code> (remember to add it to avoid port scanning). The ICMP echo scan works by sending ICMP echo requests and expecting the target to respond with ICMP echo replies if it is online.</p></div><div><p dir="auto"><img src="https://blog.kakaocdn.net/dn/ltHyM/btskZlXeU6A/eLVsh5fDEOa4R3cYhHgx10/img.png" referrerpolicy="no-referrer"></p></div><div><p dir="auto"><strong>Practice:</strong></p></div><div><p dir="auto">In the example below, the subnet of the target was scanned using <code>nmap -PE -sn MACHINE_IP/24</code>. This scan sends ICMP echo packets to all IP addresses in the subnet and expects replies from live hosts. However, it is important to remember that many firewalls block ICMP. The output below shows the results of scanning a Class C subnet on a virtual machine using AttackBox.</p></div><div><p dir="auto">Penetration Tester Terminal</p></div><div><p dir="auto">pentester@TryHackMe<strong>$</strong>&nbsp;sudo&nbsp;nmap -PE -sn&nbsp;10.10.68.220/24</p></div><div><p dir="auto">Starting Nmap 7.60 (&nbsp;<a data-tooltip-position="top" aria-label="https://nmap.org/" rel="noopener" class="external-link" href="https://nmap.org/" target="_blank">https://nmap.org</a>&nbsp;) at 2021-09-02 10:16 BST</p></div><div><p dir="auto">Nmap scan report for ip-10-10-68-50.eu-west-1.compute.internal (10.10.68.50)</p></div><div><p dir="auto">Host is up (0.00017s latency).</p></div><div><p dir="auto">MAC Address: 02:95:36:71:5B:87 (Unknown)</p></div><div><p dir="auto">Nmap scan report for ip-10-10-68-52.eu-west-1.compute.internal (10.10.68.52)</p></div><div><p dir="auto">Host is up (0.00017s latency).</p></div><div><p dir="auto">MAC Address: 02:48:E8:BF:78:E7 (Unknown)</p></div><div><p dir="auto">Nmap scan report for ip-10-10-68-77.eu-west-1.compute.internal (10.10.68.77)</p></div><div><p dir="auto">Host is up (-0.100s latency).</p></div><div><p dir="auto">MAC Address: 02:0F:0A:1D:76:35 (Unknown)</p></div><div><p dir="auto">Nmap scan report for ip-10-10-68-110.eu-west-1.compute.internal (10.10.68.110)</p></div><div><p dir="auto">Host is up (-0.10s latency).</p></div><div><p dir="auto">MAC Address: 02:6B:50:E9:C2:91 (Unknown)</p></div><div><p dir="auto">Nmap scan report for ip-10-10-68-140.eu-west-1.compute.internal (10.10.68.140)</p></div><div><p dir="auto">Host is up (0.00021s latency).</p></div><div><p dir="auto">MAC Address: 02:58:59:63:0B:6B (Unknown)</p></div><div><p dir="auto">Nmap scan report for ip-10-10-68-142.eu-west-1.compute.internal (10.10.68.142)</p></div><div><p dir="auto">Host is up (0.00016s latency).</p></div><div><p dir="auto">MAC Address: 02:C6:41:51:0A:0F (Unknown)</p></div><div><p dir="auto">Nmap scan report for ip-10-10-68-220.eu-west-1.compute.internal (10.10.68.220)</p></div><div><p dir="auto">Host is up (0.00026s latency).</p></div><div><p dir="auto">MAC Address: 02:25:3F:DB:EE:0B (Unknown)</p></div><div><p dir="auto">Nmap scan report for ip-10-10-68-222.eu-west-1.compute.internal (10.10.68.222)</p></div><div><p dir="auto">Host is up (0.00025s latency).</p></div><div><p dir="auto">MAC Address: 02:28:B1:2E:B0:1B (Unknown)</p></div><div><p dir="auto">Nmap done: 256 IP addresses (8 hosts up) scanned in 2.11 seconds</p></div><div><p dir="auto">스캔&nbsp;출력은&nbsp;8개의&nbsp;호스트가&nbsp;작동&nbsp;중임을&nbsp;보여줍니다.&nbsp;또한&nbsp;MAC&nbsp;주소를&nbsp;보여줍니다.&nbsp;일반적으로&nbsp;대상이&nbsp;우리&nbsp;시스템과&nbsp;동일한&nbsp;서브넷에&nbsp;있지&nbsp;않는&nbsp;한&nbsp;대상의&nbsp;MAC&nbsp;주소를&nbsp;알&nbsp;것으로&nbsp;기대하지&nbsp;않습니다.&nbsp;위의&nbsp;출력은&nbsp;Nmap이&nbsp;수신한&nbsp;ARP&nbsp;응답에&nbsp;따라&nbsp;이러한&nbsp;호스트가&nbsp;작동&nbsp;중임을&nbsp;확인했기&nbsp;때문에&nbsp;ICMP&nbsp;패킷을&nbsp;보낼&nbsp;필요가&nbsp;없음을&nbsp;나타냅니다.</p></div><div><p dir="auto">위의&nbsp;스캔을&nbsp;반복합니다.&nbsp;그러나&nbsp;이번에는&nbsp;다른&nbsp;서브넷에&nbsp;속한&nbsp;시스템에서&nbsp;스캔합니다.&nbsp;결과는&nbsp;비슷하지만&nbsp;MAC&nbsp;주소가&nbsp;없습니다.</p></div><div><p dir="auto">침투&nbsp;테스터&nbsp;터미널</p></div><div><p dir="auto">pentester@TryHackMe<strong>$</strong>&nbsp;sudo&nbsp;nmap -PE -sn&nbsp;10.10.68.220/24</p></div><div><p dir="auto">Starting Nmap 7.92 (&nbsp;<a data-tooltip-position="top" aria-label="https://nmap.org/" rel="noopener" class="external-link" href="https://nmap.org/" target="_blank">https://nmap.org</a>&nbsp;) at 2021-09-02 12:16 EEST</p></div><div><p dir="auto">Nmap scan report for 10.10.68.50</p></div><div><p dir="auto">Host is up (0.12s latency).</p></div><div><p dir="auto">Nmap scan report for 10.10.68.52</p></div><div><p dir="auto">Host is up (0.12s latency).</p></div><div><p dir="auto">Nmap scan report for 10.10.68.77</p></div><div><p dir="auto">Host is up (0.11s latency).</p></div><div><p dir="auto">Nmap scan report for 10.10.68.110</p></div><div><p dir="auto">Host is up (0.11s latency).</p></div><div><p dir="auto">Nmap scan report for 10.10.68.140</p></div><div><p dir="auto">Host is up (0.11s latency).</p></div><div><p dir="auto">Nmap scan report for 10.10.68.142</p></div><div><p dir="auto">Host is up (0.11s latency).</p></div><div><p dir="auto">Nmap scan report for 10.10.68.220</p></div><div><p dir="auto">Host is up (0.11s latency).</p></div><div><p dir="auto">Nmap scan report for 10.10.68.222</p></div><div><p dir="auto">Host is up (0.11s latency).</p></div><div><p dir="auto">Nmap done: 256 IP addresses (8 hosts up) scanned in 8.26 seconds</p></div><div><p dir="auto">The ICMP timestamp scan works similarly to the previous ICMP scan but sends numerous ICMP timestamp requests to all valid IP addresses in the target subnet. As seen in the Wireshark screenshot below, a single source IP address sends ICMP packets to all possible IP addresses to discover online hosts.</p></div><div><p dir="auto"><img src="https://blog.kakaocdn.net/dn/LuJno/btskT16rMqk/o3HvCvHSkTbm0KpSEkngBK/img.png" referrerpolicy="no-referrer"></p></div><div><p dir="auto">Similarly, Nmap uses the Address Mask Request (ICMP Type 17) and expects an Address Mask Reply (ICMP Type 18). This scan can be enabled optionally with <code>-PM</code>. As shown in the figure below, live hosts should respond to ICMP Address Mask Requests.</p></div><div><p dir="auto"><img src="https://blog.kakaocdn.net/dn/kP83P/btskSRwrv2B/GannwKzKDt3488weRrG6F0/img.png" referrerpolicy="no-referrer"></p></div><div><p dir="auto">To perform a live host scan using ICMP Address Mask, run the following command: <code>nmap -PM -sn MACHINE_IP/24</code>. Based on the previous scan, you know at least 8 hosts are up, but this scan returned nothing. This is likely because the target system or firewall in the path is blocking these types of ICMP packets. Therefore, it's essential to learn multiple methods to achieve the same result. If one type of packet is blocked, always try another type to search the target network and services.</p></div><div><p dir="auto">Penetration Tester Terminal:</p></div><div><p dir="auto">bash</p></div><div><p dir="auto">코드 복사</p></div><div><p dir="auto"><code>pentester@TryHackMe$ sudo nmap -PM -sn 10.10.68.220/24</code></p></div><div><p dir="auto">Starting Nmap 7.92 (<a data-tooltip-position="top" aria-label="https://nmap.org/" rel="noopener" class="external-link" href="https://nmap.org/" target="_blank">https://nmap.org</a>) at 2021-09-02 12:13 EEST</p></div><div><p dir="auto">Nmap done: 256 IP addresses (0 hosts up) scanned in 52.17 seconds</p></div><div><p dir="auto">No responses were received, and no hosts could be determined as online, but note that this scan sent ICMP Address Mask Requests to all valid IP addresses and waited for responses. As shown in the screenshot below, each ICMP request was sent twice.</p></div><div><p dir="auto"><img src="https://blog.kakaocdn.net/dn/zKgRM/btskZsBV8xQ/zgnKoswSAG8ww5UlVUhHm0/img.png" referrerpolicy="no-referrer"></p></div><div><p dir="auto"><strong>Questions:</strong></p></div><div><ol>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p>What option instructs Nmap to use ICMP timestamp to discover live hosts?</p>
<ul>
<li data-line="2" dir="auto">Answer: <code>-PP</code></li>
</ul>
</li>
<li data-line="3" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p>What option instructs Nmap to use ICMP Address Mask to discover live hosts?</p>
<ul>
<li data-line="5" dir="auto">Answer: <code>-PM</code></li>
</ul>
</li>
<li data-line="6" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p>What option instructs Nmap to use ICMP Echo to discover live hosts?</p>
<ul>
<li data-line="8" dir="auto">Answer: <code>-PE</code></li>
</ul>
</li>
</ol></div><div><p dir="auto"><strong>6. Host Discovery Using TCP and UDP</strong></p></div><div><p dir="auto"><strong>TCP SYN Ping</strong></p></div><div><p dir="auto">You can send packets with the SYN (synchronize) flag set to a TCP port (default is 80) and wait for responses. Open ports should respond with SYN/ACK (acknowledge), while closed ports will result in an RST (reset). In this case, you only check if you receive a response to infer if the host is up. The specific state of the port is not important. The following image reminds us how the TCP 3-way handshake typically works.</p></div><div><p dir="auto"><img src="https://blog.kakaocdn.net/dn/kTlq5/btskZs9NL2h/AjLtC44IMH16MtRWi00tDk/img.png" referrerpolicy="no-referrer"></p></div><div><p dir="auto">To use TCP SYN ping with Nmap, you can do so by specifying the port number, range, or list after the <code>-PS</code> option. For example:</p></div><div><ul>
<li data-line="0" dir="auto"><code>-PS21</code> targets port 21.</li>
<li data-line="1" dir="auto"><code>-PS21-25</code> targets ports 21, 22, 23, 24, and 25.</li>
<li data-line="2" dir="auto"><code>-PS80,443,8080</code> targets ports 80, 443, and 8080.</li>
</ul></div><div><p dir="auto">Privileged users (root and sudoers) can send TCP SYN packets, as shown in the following image, without needing to complete the TCP 3-way handshake even if the port is open. Unprivileged users will have to complete the 3-way handshake if the port is open.</p></div><div><p dir="auto"><img src="https://blog.kakaocdn.net/dn/J3Mjy/btskTF3yvNg/KG5uHiI6kkxKgaCiexsYo0/img.png" referrerpolicy="no-referrer"></p></div><div><p dir="auto">Run <code>nmap -PS -sn MACHINE_IP/24</code> to scan the target VM subnet. As seen in the output below, five hosts were discovered.</p></div><div><p dir="auto">Penetration Tester Terminal:</p></div><div><p dir="auto">bash</p></div><div><p dir="auto">코드 복사</p></div><div><p dir="auto"><code>pentester@TryHackMe$ sudo nmap -PS -sn 10.10.68.220/24</code></p></div><div><p dir="auto">Starting Nmap 7.92 (<a data-tooltip-position="top" aria-label="https://nmap.org/" rel="noopener" class="external-link" href="https://nmap.org/" target="_blank">https://nmap.org</a>) at 2021-09-02 13:45 EEST</p></div><div><p dir="auto">Nmap scan report for 10.10.68.52</p></div><div><p dir="auto">Host is up (0.10s latency).</p></div><div><p dir="auto">Nmap scan report for 10.10.68.121</p></div><div><p dir="auto">Host is up (0.16s latency).</p></div><div><p dir="auto">Nmap scan report for 10.10.68.125</p></div><div><p dir="auto">Host is up (0.089s latency).</p></div><div><p dir="auto">Nmap scan report for 10.10.68.134</p></div><div><p dir="auto">Host is up (0.13s latency).</p></div><div><p dir="auto">Nmap scan report for 10.10.68.220</p></div><div><p dir="auto">Host is up (0.11s latency).</p></div><div><p dir="auto">Nmap done: 256 IP addresses (5 hosts up) scanned in 17.38 seconds</p></div><div><p dir="auto">As seen in the figure below, we observe network traffic in Wireshark, and Nmap sent TCP packets to common TCP ports. In this case, it used TCP port 80. Any service receiving on port 80 should respond to indicate that the host is online.</p></div><div><p dir="auto"><img src="https://blog.kakaocdn.net/dn/r9bTp/btskTIMKz2Q/GeCBgo8LTwtiZodc1SRTQ0/img.png" referrerpolicy="no-referrer"></p></div><div><p dir="auto"><strong>TCP ACK Ping</strong></p></div><div><p dir="auto">As you might guess, this sends packets with the ACK flag set. To perform this, Nmap must be run with privileges. Attempting this with unprivileged accounts will cause Nmap to try the 3-way handshake.</p></div><div><p dir="auto">By default, port 80 is used. The syntax is similar to TCP SYN ping. You should specify the port number, range, or list after the <code>-PA</code> option. For example:</p></div><div><ul>
<li data-line="0" dir="auto"><code>-PA21</code> and <code>-PA21-25</code></li>
<li data-line="1" dir="auto"><code>-PA80,443,8080</code></li>
</ul></div><div><p dir="auto">The following image shows that all TCP packets with the ACK flag should respond with TCP packets with the RST flag set. Since the ACK flag is in packets not part of an ongoing connection, the RST flag is set in the response. This response is used to determine if the target host is up.</p></div><div><p dir="auto"><img src="https://blog.kakaocdn.net/dn/cOgPyY/btskY7kHlaW/OyqV0Ikym4tzHYTwM3WrU0/img.png" referrerpolicy="no-referrer"></p></div><div><p dir="auto">Run <code>sudo nmap -PA -sn MACHINE_IP/24</code> to search for online hosts in the target subnet. The TCP ACK ping scan detected 5 hosts up.</p></div><div><p dir="auto">Penetration Tester Terminal:</p></div><div><p dir="auto">bash</p></div><div><p dir="auto">코드 복사</p></div><div><p dir="auto"><code>pentester@TryHackMe$ sudo nmap -PA -sn 10.10.68.220/24</code></p></div><div><p dir="auto">Starting Nmap 7.92 (<a data-tooltip-position="top" aria-label="https://nmap.org/" rel="noopener" class="external-link" href="https://nmap.org/" target="_blank">https://nmap.org</a>) at 2021-09-02 13:46 EEST</p></div><div><p dir="auto">Nmap scan report for 10.10.68.52</p></div><div><p dir="auto">Host is up (0.11s latency).</p></div><div><p dir="auto">Nmap scan report for 10.10.68.121</p></div><div><p dir="auto">Host is up (0.12s latency).</p></div><div><p dir="auto">Nmap scan report for 10.10.68.125</p></div><div><p dir="auto">Host is up (0.10s latency).</p></div><div><p dir="auto">Nmap scan report for 10.10.68.134</p></div><div><p dir="auto">Host is up (0.10s latency).</p></div><div><p dir="auto">Nmap scan report for 10.10.68.220</p></div><div><p dir="auto">Host is up (0.10s latency).</p></div><div><p dir="auto">Nmap done: 256 IP addresses (5 hosts up) scanned in 29.89 seconds</p></div><div><p dir="auto">As shown in the figure below, we can see many packets with the ACK flag set and sent to port 80 of the target system. Nmap sends each packet twice. Systems that do not respond are either offline or inaccessible.</p></div><div><p dir="auto"><img src="https://blog.kakaocdn.net/dn/boxftR/btskZVcHyuZ/MfOY4enffmv1OtmaqkHDnk/img.png" referrerpolicy="no-referrer"></p></div><div><p dir="auto"><strong>UDP Ping</strong></p></div><div><p dir="auto">Finally, you can use UDP to check if a host is online. Unlike TCP SYN ping, you would expect no response when sending UDP packets to open ports. However, if you send UDP packets to closed UDP ports, you will receive ICMP "Destination Unreachable" errors. This indicates that the target system is up and reachable.</p></div><div><p dir="auto">The following image shows UDP packets sent to open UDP ports, which do not trigger a response. However, sending UDP packets to closed UDP ports can trigger a response indicating the target is online.</p></div><div><p dir="auto"><img src="https://blog.kakaocdn.net/dn/Bu4kn/btskY51tBDp/1KbOjnXk5Vj1LSL7HCAJr1/img.png" referrerpolicy="no-referrer"></p></div><div><p dir="auto"><img src="https://blog.kakaocdn.net/dn/uiDL6/btskZsvb6QV/qcpTSCGkqlVopg1hBIEzgK/img.png" referrerpolicy="no-referrer"></p></div><div><p dir="auto">The syntax for specifying ports is similar to TCP SYN ping and TCP ACK ping. Nmap uses <code>-PU</code> for UDP ping. The command <code>nmap -PU -sn MACHINE_IP/24</code> will search for online hosts in the subnet.</p></div><div><p dir="auto">Penetration Tester Terminal:</p></div><div><p dir="auto">bash</p></div><div><p dir="auto">코드 복사</p></div><div><p dir="auto"><code>pentester@TryHackMe$ sudo nmap -PU -sn 10.10.68.220/24</code></p></div><div><p dir="auto">Starting Nmap 7.92 (<a data-tooltip-position="top" aria-label="https://nmap.org/" rel="noopener" class="external-link" href="https://nmap.org/" target="_blank">https://nmap.org</a>) at 2021-09-02 13:47 EEST</p></div><div><p dir="auto">Nmap scan report for 10.10.68.52</p></div><div><p dir="auto">Host is up (0.10s latency).</p></div><div><p dir="auto">Nmap scan report for 10.10.68.121</p></div><div><p dir="auto">Host is up (0.11s latency).</p></div><div><p dir="auto">Nmap scan report for 10.10.68.125</p></div><div><p dir="auto">Host is up (0.11s latency).</p></div><div><p dir="auto">Nmap scan report for 10.10.68.134</p></div><div><p dir="auto">Host is up (0.11s latency).</p></div><div><p dir="auto">Nmap scan report for 10.10.68.220</p></div><div><p dir="auto">Host is up (0.11s latency).</p></div><div><p dir="auto">Nmap done: 256 IP addresses (5 hosts up) scanned in 16.92 seconds</p></div><div><p dir="auto">As shown in the following image, the result of the UDP scan was similar to the TCP scan. The scan returned 5 hosts as online.</p></div><div><p dir="auto"><strong>Questions:</strong></p></div><div><p dir="auto">What option instructs Nmap to use TCP SYN ping to discover live hosts?</p></div><div><ul>
<li data-line="0" dir="auto">Answer: <code>-PS</code><br>
What option instructs Nmap to use TCP ACK ping to discover live hosts?</li>
<li data-line="2" dir="auto">Answer: <code>-PA</code><br>
What option instructs Nmap to use UDP ping to discover live hosts?</li>
<li data-line="4" dir="auto">Answer: <code>-PU</code></li>
</ul></div></div></div><div class="heading-wrapper"><h4 data-heading="7. Using Reverse DNS Lookup" dir="auto" class="heading" id="7._Using_Reverse_DNS_Lookup"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>7. Using Reverse DNS Lookup</h4><div class="heading-children"><div><p dir="auto">By default, Nmap performs reverse DNS lookups on online hosts. Since hostnames can reveal a lot of information, this can be a useful step. However, if you want to skip this step and avoid sending these DNS queries, you can use the <code>-n</code> option.</p></div><div><p dir="auto">By default, Nmap will find online hosts. However, you can also query DNS servers for offline hosts by using the <code>-R</code> option. If you want to use a specific DNS server, you can add the <code>--dns-servers DNS_SERVER</code> option.</p></div><div><p dir="auto"><strong>Question:</strong></p></div><div><p dir="auto">What option instructs Nmap to use reverse DNS lookups on all hosts?</p></div><div><p dir="auto">Answer: <code>-R</code></p></div></div></div><div class="heading-wrapper"><h4 data-heading="8. Summary" dir="auto" class="heading" id="8._Summary"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>8. Summary</h4><div class="heading-children"><div><p dir="auto">In this section, you learned how ARP, ICMP, TCP, and UDP can be used to detect live hosts. Any response from a host indicates that the host is online. Below is a brief summary of the Nmap command-line options we covered:</p></div><div dir="ltr" style="overflow-x: auto;"><table>
<thead>
<tr>
<th dir="ltr"><strong>Scan Type</strong></th>
<th dir="ltr"><strong>Example Command</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td dir="ltr">ARP Scan</td>
<td dir="ltr"><code>sudo nmap -PR -sn MACHINE_IP/24</code></td>
</tr>
<tr>
<td dir="ltr">ICMP Echo Scan</td>
<td dir="ltr"><code>sudo nmap -PE -sn MACHINE_IP/24</code></td>
</tr>
<tr>
<td dir="ltr">ICMP Timestamp Scan</td>
<td dir="ltr"><code>sudo nmap -PP -sn MACHINE_IP/24</code></td>
</tr>
<tr>
<td dir="ltr">ICMP Address Mask Scan</td>
<td dir="ltr"><code>sudo nmap -PM -sn MACHINE_IP/24</code></td>
</tr>
<tr>
<td dir="ltr">TCP SYN Ping Scan</td>
<td dir="ltr"><code>sudo nmap -PS22,80,443 -sn MACHINE_IP/30</code></td>
</tr>
<tr>
<td dir="ltr">TCP ACK Ping Scan</td>
<td dir="ltr"><code>sudo nmap -PA22,80,443 -sn MACHINE_IP/30</code></td>
</tr>
<tr>
<td dir="ltr">UDP Ping Scan</td>
<td dir="ltr"><code>sudo nmap -PU53,161,162 -sn MACHINE_IP/30</code></td>
</tr>
</tbody>
</table></div><div><p dir="auto">If you are only interested in host discovery without port scanning, you should include <code>-sn</code>. Omitting it means Nmap will perform a port scan by default.</p></div><div dir="ltr" style="overflow-x: auto;"><table>
<thead>
<tr>
<th dir="ltr"><strong>Option</strong></th>
<th dir="ltr"><strong>Purpose</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td dir="ltr"><code>-n</code></td>
<td dir="ltr">No DNS resolution</td>
</tr>
<tr>
<td dir="ltr"><code>-R</code></td>
<td dir="ltr">Reverse DNS lookup for all hosts</td>
</tr>
<tr>
<td dir="ltr"><code>-sn</code></td>
<td dir="ltr">Host discovery only</td>
</tr>
</tbody>
</table></div><div class="mod-footer"></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button is-collapsed" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="achive\tryhackme\jr-penetration-tester\네트워크-보안\eng\3.-nmap-live-host-search.html#3. Nmap Live Host Search"><div class="tree-item-contents heading-link" heading-name="
Nmap Live Host Search
"><span class="tree-item-title">Nmap Live Host Search</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible is-collapsed" data-depth="2"><a class="tree-link" href="achive\tryhackme\jr-penetration-tester\네트워크-보안\eng\3.-nmap-live-host-search.html#Nmap_Live_Host_Search"><div class="tree-item-contents heading-link" heading-name="Nmap Live Host Search"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Nmap Live Host Search</span></div></a><div class="tree-item-children nav-folder-children" style="display: none;"><div class="tree-item" data-depth="4"><a class="tree-link" href="achive\tryhackme\jr-penetration-tester\네트워크-보안\eng\3.-nmap-live-host-search.html#Overview"><div class="tree-item-contents heading-link" heading-name="Overview"><span class="tree-item-title">Overview</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="achive\tryhackme\jr-penetration-tester\네트워크-보안\eng\3.-nmap-live-host-search.html#1._Subnet"><div class="tree-item-contents heading-link" heading-name="1. Subnet"><span class="tree-item-title">1. 
Subnet
</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="achive\tryhackme\jr-penetration-tester\네트워크-보안\eng\3.-nmap-live-host-search.html#2._Target_Enumeration"><div class="tree-item-contents heading-link" heading-name="2. Target Enumeration"><span class="tree-item-title">2. 
Target Enumeration
</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="achive\tryhackme\jr-penetration-tester\네트워크-보안\eng\3.-nmap-live-host-search.html#3._Live_Host_Discovery"><div class="tree-item-contents heading-link" heading-name="3. Live Host Discovery"><span class="tree-item-title">3. 
Live Host Discovery
</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="achive\tryhackme\jr-penetration-tester\네트워크-보안\eng\3.-nmap-live-host-search.html#4._Host_Discovery_with_Nmap_Using_ARP"><div class="tree-item-contents heading-link" heading-name="4. Host Discovery with Nmap Using ARP"><span class="tree-item-title">4. 
Host Discovery with Nmap Using ARP
</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="achive\tryhackme\jr-penetration-tester\네트워크-보안\eng\3.-nmap-live-host-search.html#5._Host_Discovery_Using_ICMP_with_Nmap"><div class="tree-item-contents heading-link" heading-name="5. Host Discovery Using ICMP with Nmap"><span class="tree-item-title">5. 
Host Discovery Using ICMP with Nmap
</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="achive\tryhackme\jr-penetration-tester\네트워크-보안\eng\3.-nmap-live-host-search.html#7._Using_Reverse_DNS_Lookup"><div class="tree-item-contents heading-link" heading-name="7. Using Reverse DNS Lookup"><span class="tree-item-title">7. 
Using Reverse DNS Lookup
</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="achive\tryhackme\jr-penetration-tester\네트워크-보안\eng\3.-nmap-live-host-search.html#8._Summary"><div class="tree-item-contents heading-link" heading-name="8. Summary"><span class="tree-item-title">8. 
Summary
</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>